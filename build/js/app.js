!function(t){function e(e){for(var i,r,n=e[0],h=e[1],l=e[2],d=0,m=[];d<n.length;d++)r=n[d],Object.prototype.hasOwnProperty.call(o,r)&&o[r]&&m.push(o[r][0]),o[r]=0;for(i in h)Object.prototype.hasOwnProperty.call(h,i)&&(t[i]=h[i]);for(c&&c(e);m.length;)m.shift()();return a.push.apply(a,l||[]),s()}function s(){for(var t,e=0;e<a.length;e++){for(var s=a[e],i=!0,n=1;n<s.length;n++){var h=s[n];0!==o[h]&&(i=!1)}i&&(a.splice(e--,1),t=r(r.s=s[0]))}return t}var i={},o={0:0},a=[];function r(e){if(i[e])return i[e].exports;var s=i[e]={i:e,l:!1,exports:{}};return t[e].call(s.exports,s,s.exports,r),s.l=!0,s.exports}r.m=t,r.c=i,r.d=function(t,e,s){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(r.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)r.d(s,i,function(e){return t[e]}.bind(null,i));return s},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="";var n=window.webpackJsonp=window.webpackJsonp||[],h=n.push.bind(n);n.push=e,n=n.slice();for(var l=0;l<n.length;l++)e(n[l]);var c=h;a.push([49,1]),s()}({27:function(t,e,s){var i=s(28),o=s(29);"string"==typeof(o=o.__esModule?o.default:o)&&(o=[[t.i,o,""]]);var a={insert:"head",singleton:!1};i(o,a);t.exports=o.locals||{}},29:function(t,e,s){(e=s(30)(!1)).push([t.i,'html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td,article,aside,canvas,details,embed,figure,figcaption,footer,header,hgroup,menu,nav,output,ruby,section,summary,time,mark,audio,video{margin:0;padding:0;border:0;font-size:100%;font:inherit;vertical-align:baseline}article,aside,details,figcaption,figure,footer,header,hgroup,menu,nav,section{display:block}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:"";content:none}table{border-collapse:collapse;border-spacing:0}body{margin:0;padding:0;background-color:#000}div,section,nav,article{box-sizing:border-box}html,body{margin:0;padding:0;width:100%;height:100%}body{font-family:"Helvetica Neue",Arial,"Hiragino Kaku Gothic ProN","Hiragino Sans",Meiryo,sans-serif;background-color:#000;overflow:hidden}.common_container{position:fixed;top:0;left:0;z-index:1}.common_screen_shade{position:fixed;width:100%;height:100%;z-index:2;background-color:#000}#content_container{position:relative}#background_container{z-index:1}#WebGL-output{width:100%;height:100%}#detail_container{z-index:20;visibility:hidden}#blocker{position:absolute}html,body{margin:0;padding:0;width:100%;height:100%}body{font-family:"Helvetica Neue",Arial,"Hiragino Kaku Gothic ProN","Hiragino Sans",Meiryo,sans-serif;background-color:#000;overflow:hidden}.common_container{position:fixed;top:0;left:0;z-index:1;visibility:visible;display:block}.common_screen_shade{position:fixed;width:100%;height:100%;z-index:2;background-color:#000}#content_container{position:relative}#background_container{z-index:1}#WebGL-output{width:100%;height:100%}#category_container{z-index:10}#category_stage{position:relative}#gallery_container{z-index:11}#dialog{position:fixed;top:0;left:0;color:#fff}#dialog button{padding:1em;font-size:1em}#buttons{position:fixed;top:0;right:0;z-index:1;background:#fff}#detail_container{z-index:20;visibility:hidden}#blocker{position:absolute}#xr_mode #content_container{position:fixed}#xr_mode #xr_scene{z-index:200}#xr_mode #hud_container{z-index:250}#xr_mode .hud_ui{position:absolute;top:300px;width:520px;height:140px;display:flex;align-items:center;justify-content:center;color:#fff;font-size:40px;font-weight:bold;background-color:rgba(200,200,200,.8);box-sizing:border-box}#xr_mode .gallery_poster_title{position:absolute;top:0;width:14.5em;height:7em;font-size:36px;line-height:1.4;color:#fff;font-weight:bold;background-color:rgba(0,0,0,.8);padding:2em .5em 0;box-sizing:border-box;user-select:none}#xr_mode .category_content_container{position:absolute;width:520px;height:520px;padding:80px .5em 0;font-size:36px;line-height:1.4;text-align:center;color:#fff;font-weight:bold;background-color:rgba(200,200,200,.8);box-sizing:border-box;user-select:none}#xr_mode .category_a{background:rgba(150,41,204,.6)}#xr_mode .category_b{background:rgba(41,95,204,.6)}#xr_mode .category_c{background:rgba(36,179,83,.6)}#xr_mode .category_d{background:rgba(46,199,230,.6)}#xr_mode .category_e{background:rgba(41,204,190,.6)}#xr_mode .category_f{background:rgba(68,41,204,.6)}#xr_mode .category_s{background:rgba(204,41,149,.6)}#xr_mode .category_id{font-size:48px;line-height:1;margin-bottom:20px}#xr_mode .category_title.english{font-size:40px;line-height:1.24}#xr_mode .category_title.japanese{position:absolute;top:300px;width:92%;text-align:center;font-weight:normal;font-size:24px}#xr_mode .category_copy{position:absolute;top:348px;width:92%;text-align:center;font-size:32px}#xr_mode #detail_container{visibility:visible;font-size:2rem}#xr_mode .detail_content_container{position:fixed;top:0;width:512px;height:512px;padding:2rem;font-size:24px;line-height:1.4;text-align:left;color:#000;font-weight:normal;background-color:rgba(255,255,255,.9);box-sizing:border-box;user-select:none}#xr_mode .detail_content_container.summary{padding:2rem 2rem 2rem}#xr_mode .detail_content_container_inner{position:relative;width:100%;height:100%;overflow:hidden}#xr_mode .detail_header_container{position:relative;margin-bottom:2.5rem}#xr_mode .slug{position:relative;line-height:1;font-size:1.4em;padding:.1rem 0 0 0}#xr_mode .category_jp{position:absolute;left:4.5rem;top:0;font-size:.6em;font-weight:bold}#xr_mode .category_en{position:absolute;left:4.5rem;top:1.2rem;font-size:.5em}#xr_mode .detail_theme_container{position:relative;margin-bottom:1.5rem}#xr_mode .theme_jp{font-size:.6em;font-weight:bold}#xr_mode .theme_en{font-size:.4em;margin-bottom:1rem}#xr_mode .detail_title_container{position:relative;margin-bottom:1.5em}#xr_mode .title_jp{font-size:1em;font-weight:bold;margin-bottom:.5rem}#xr_mode .title_en{font-size:.5em;margin-bottom:.1rem}#xr_mode .detail_author_container{position:relative;text-align:right;font-size:.6em}#xr_mode .leader_name_jp,#xr_mode .research_field_jp,#xr_mode .group_members_jp{font-weight:bold}#xr_mode .leader_name_en,#xr_mode .research_field_en,#xr_mode .group_members_en{font-size:.8em;margin-bottom:.5rem}#xr_mode .detail_summary_container{position:relative;font-size:.7em;line-height:1.7}#xr_mode .summary_jp{font-size:1em;margin-bottom:1rem}#xr_mode .summary_en{font-size:.7em}#xr_mode .detail_summary_container.split .summary_jp{margin-bottom:0}#xr_mode .detail_summary_container.split .summary_en{line-height:1.6;font-size:.85em}',""]),t.exports=e},49:function(t,e,s){"use strict";s.r(e);s(27);var i={init(){Object.defineProperty(Object.prototype,"forIn",{value:function(t,e){e=e||this,Object.keys(this).forEach((function(s,i){const o=this[s];t.call(e,s,o,i)}),this)}}),Object.defineProperty(Object.prototype,"isEmpty",{value:function(t,e){return!Object.keys(this).length}})}};const o={instance:null,events:[]},a={ShowPoster:"ShowPoster",ShowDetail:"ShowDetail",BackToCategory:"BackToCategory",BackToPoster:"BackToPoster",VRModeStart:"VRModeStart",ShowCategoryA:"ShowCategoryA",ShowCategoryB:"ShowCategoryB",ShowCategoryC:"ShowCategoryC",ShowCategoryD:"ShowCategoryD",ShowCategoryE:"ShowCategoryE",ShowCategoryF:"ShowCategoryF",ShowCategoryG:"ShowCategoryG"},r={dispatch:(t,e)=>{if(!(t in a)||null==o.instance)return!1;o.instance.dispatchEvent(new CustomEvent(t,{detail:e}))},addListener:(t,e)=>{if(!(t in a))return!1;o.instance=null!=o.instance?o.instance:document.createElement("div"),o.instance.addEventListener(t,t=>{null!=e&&e(t.detail)}),o.events.push({event:e})},addEventListener(t,e){this.addListener(t,e)},add(t,e){this.addListener(t,e)}},n={enable:!1},h=32,l=a,c="background_container",d="hud_ui_stage",m="category_stage",p="gallery_container",g="gallery_stage",u="detail_container",f="detail_stage",y="detail_blocker",b="xr_scene",_="xr_player",w="xr_raycaster",C="xr_raycast_target",T="xr_hud_container",v="xr_category_board_container",x="xr_poster_panel_container",B="xr_poster_title_container",E="xr_detail_container",k="background-component",S="gallery-component",P="detail-component",L="raycast-check-component",M="raycast-target-component",A="category",I="poster",D="detail",j={BackToCategory:"ui_back_category",BackToPoster:"ui_back_poster",VRModeStart:"VRModeStart",ShowCategoryA:"ShowCategoryA",ShowCategoryB:"ShowCategoryB",ShowCategoryC:"ShowCategoryC",ShowCategoryD:"ShowCategoryD",ShowCategoryE:"ShowCategoryE",ShowCategoryF:"ShowCategoryF",ShowCategoryG:"ShowCategoryG"},z=10066329,R=16777215,V=(t=null)=>n.enable,G=(t,e=0,s={})=>{null!=t&&setTimeout(()=>t(s),e)},U={init(){return this},setup(){},update(){},draw(){},destroy(){},onResize(){},onMouseMove(t){},onKeyUp(t){},onClick(t){}};var O=s(0);const W=75,F=83,K=32,H=65,$=66,N=67,q=68,J=69,X=70,Z=71,Q=8;s(31);var Y=s(19),tt=s(20),et=s(5),st=s(21),it=s(6),ot=s(26),at=s(22),rt=s(3),nt=s(7),ht={uniforms:{tDiffuse:{value:null},color:{value:new nt.Color(16711680)},color2:{value:new nt.Color(16711680)}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform vec3 color;","uniform vec3 color2;","uniform sampler2D tDiffuse;","varying vec2 vUv;","void main() {","vec4 texel = texture2D( tDiffuse, vUv );","vec3 luma = vec3( 0.299, 0.587, 0.114 );","float v = dot( texel.xyz, luma );","vec3 gradate = color * vUv.y + color2 * (1.0 - vUv.y);","gl_FragColor = vec4(v * gradate, texel.w );","}"].join("\n")};class lt{constructor(t){this._initStats=this._initStats.bind(this),this.chooseRoomColor=this.chooseRoomColor.bind(this),this._stats=this._initStats(),this._scene=t,this._renderer=new O.WebGLRenderer({antialias:!0,alpha:!0}),this._renderer.setClearColor(new O.Color(0),0),this._renderer.setSize(window.innerWidth,window.innerHeight),this._renderer.setPixelRatio(1),this._wrapper=document.getElementById("WebGL-output"),this._wrapper.appendChild(this._renderer.domElement),this.clock=new O.Clock,this.onResize();var e=new tt.a(this._scene,this._scene.camera);e.clear=!0;new et.b(this._scene,this._scene.camera),new st.a;this.colorify=new it.a(ht),this.gradColor1=7556260,this.gradColor2=322168,this.colorify.uniforms.color.value=new O.Color(this.gradColor1),this.colorify.uniforms.color2.value=new O.Color(this.gradColor2),this.colorify.uniforms.alpha=.8,this.colorify.enabled=!0;var s=new ot.a(2,15,3,64);s.enabled=!0;var i=new it.a(rt.a);i.renderToScreen=!0,this.composer=new at.a(this._renderer),this.composer.renderTarget1.stencilBuffer=!0,this.composer.renderTarget2.stencilBuffer=!0,this.composer.addPass(e),this.composer.addPass(this.colorify),this.composer.addPass(s),this.composer.addPass(i)}update(){this._stats.update(),this._renderer.autoClear=!1,this._scene.update(),this.composer.render()}onKeyUp(t){t.keyCode==H&&this.chooseRoomColor(this._scene.camTargetBool_A,9841100,9841100),t.keyCode==$&&this.chooseRoomColor(this._scene.camTargetBool_B,2711500,2711500),t.keyCode==N&&this.chooseRoomColor(this._scene.camTargetBool_C,2404947,2404947),t.keyCode==q&&this.chooseRoomColor(this._scene.camTargetBool_D,3065829,3065829),t.keyCode==J&&this.chooseRoomColor(this._scene.camTargetBool_E,2739390,2739390),t.keyCode==X&&this.chooseRoomColor(this._scene.camTargetBool_F,4467148,4467148),t.keyCode==Z&&this.chooseRoomColor(this._scene.camTargetBool_G,13379989,13379989),t.keyCode==Q&&this.chooseRoomColor(this._scene.camTargetBool_BACKSPACE,this.gradColor1,this.gradColor2),this._scene.onKeyUp(t)}chooseRoomColor(t,e,s){1==t&&(this.colorify.uniforms.color.value=new O.Color(e),this.colorify.uniforms.color2.value=new O.Color(s))}addEvent(){this._scene.addEvent()}draw(){}onResize(){const t=this._wrapper.clientWidth,e=this._wrapper.clientHeight;this._renderer.domElement.setAttribute("width",String(t)),this._renderer.domElement.setAttribute("height",String(e)),this._renderer.setPixelRatio(window.devicePixelRatio||1),this._renderer.setSize(t,e),this._scene.camera.aspect=t/e,this._scene.camera.updateProjectionMatrix()}_initStats(){return this._stats=new Y.a,this._stats.setMode(0),this._stats.domElement.style.position="absolute",this._stats.domElement.style.left="0px",this._stats.domElement.style.top="0px",document.getElementById("Stats-output").appendChild(this._stats.domElement),this._stats}}class ct extends O.PerspectiveCamera{constructor(){super(45,window.innerWidth/window.innerHeight,1,1e3),this.frame=0,this.eansingBool=!0,this.camPos=new O.Vector3(100,300,120),this.camTarget=new O.Vector3(-370,300,320),this.lookPos=new O.Vector3(45,50,45),this.lookTarget=new O.Vector3(45,50,45),this.getCamPos=this.getCamPos.bind(this)}update(){this.frame<1800?this.frame+=1:(this.frame=1800,this.eansingBool),1==this.eansingBool&&(this.camPos.x+=.012*(this.camTarget.x-this.camPos.x),this.camPos.y+=.012*(this.camTarget.y-this.camPos.y),this.camPos.z+=.012*(this.camTarget.z-this.camPos.z),this.position.set(this.camPos.x,this.camPos.y,this.camPos.z),this.lookPos.x+=.02*(this.lookTarget.x-this.lookPos.x),this.lookPos.y+=.02*(this.lookTarget.y-this.lookPos.y),this.lookPos.z+=.02*(this.lookTarget.z-this.lookPos.z),this.lookAt(this.lookPos)),this.frame>=0&&this.frame<1170&&(30==this.frame&&(this.camTarget=new O.Vector3(-320,50,-200)),50==this.frame&&(this.camTarget=new O.Vector3(-20,-130,-150)),130==this.frame&&(this.lookTarget=new O.Vector3(45,80,45)),280==this.frame&&(this.lookTarget=new O.Vector3(45,50,45),this.camTarget=new O.Vector3(-120,350,320)),460==this.frame&&(this.frame+=320),420==this.frame&&(this.camTarget=new O.Vector3(170,150,50)),700==this.frame&&(this.camTarget=new O.Vector3(230,60,-60)),900==this.frame&&(this.camTarget=new O.Vector3(100,-100,-130))),1150==this.frame&&(this.frame+=50),this.frame>=1200&&(1200==this.frame&&(this.lookTarget=new O.Vector3(140,70,140),this.camTarget=new O.Vector3(240,480,160)),this.frame,1370==this.frame&&(this.lookTarget=new O.Vector3(70,40,70),this.camTarget=new O.Vector3(10,3,-20)))}getCamPos(){}}var dt=s(9),mt=s(8),pt=s.n(mt);const gt=(t,e)=>{if(null==t||null==e)return;const s=new XMLHttpRequest,i=t=>{e({result:t.target.response}),s.removeEventListener("load",i)};s.addEventListener("load",i),s.open("GET",t,!0),s.send()};class ut extends O.Object3D{constructor(t,e){super(),this.frame=0,this.Times=0,this.prepareMesh=this.prepareMesh.bind(this),this.checkIntersection=this.checkIntersection.bind(this),this.getlineLength=this.getlineLength.bind(this),this.loadCSVandConvertToArray2D=this.loadCSVandConvertToArray2D.bind(this),this.doSomething=this.doSomething.bind(this),this.meshes={},this.meshes[0]||(this.meshes[0]=this.prepareMesh()),this.lineLength=0,this.where=t,this.inout=e,this.data=[],this.loadCSVandConvertToArray2D(),this.DATAisOK=!1}prepareMesh(){for(var t=new Float32Array(300),e=0;e<t.length;e+=3)t[e]=t[e+1]=t[e+2]=0;var s=new dt.MeshLine;s.setGeometry(t,(function(t){return t}));let i=new dt.MeshLineMaterial({color:11250603,lineWidth:.8,depthTest:!1});return this.mesh=new O.Mesh(s.geometry,i),this.mesh.geo=t,this.mesh.g=s,this.add(this.mesh),this.mesh}checkIntersection(){this.mesh=this.meshes[0];for(var t=this.mesh.geo,e=this.mesh.g,s=0;s<t.length;s+=3)t[s]=1*t[s+3],t[s+1]=1*t[s+4],t[s+2]=1*t[s+5];let i=Math.random();this.getlineLength();let o=Math.random();this.lineLength*=o<.5?-1:1,i>.66?(t[t.length-6]>90&&this.lineLength>0&&(this.lineLength*=-1),t[t.length-6]<-45&&this.lineLength<0&&(this.lineLength*=-1),t[t.length-3]=t[t.length-6]+this.lineLength,t[t.length-2]=t[t.length-5],t[t.length-1]=t[t.length-4]):i>.33?(t[t.length-5]>90&&this.lineLength>0&&(this.lineLength*=-1),t[t.length-5]<-45&&this.lineLength<0&&(this.lineLength*=-1),t[t.length-3]=t[t.length-6],t[t.length-2]=t[t.length-5]+this.lineLength,t[t.length-1]=t[t.length-4]):(t[t.length-4]>90&&this.lineLength>0&&(this.lineLength*=-1),t[t.length-4]<-45&&this.lineLength<0&&(this.lineLength*=-1),t[t.length-3]=t[t.length-6],t[t.length-2]=t[t.length-5],t[t.length-1]=t[t.length-4]+this.lineLength),e.setGeometry(t)}getlineLength(){return this.lineLength=this.data[this.Times][2*this.where+this.inout]/1e7*.3,this.Times+=1,12==this.Times&&(this.Times=0),this.lineLength}loadCSVandConvertToArray2D(){gt("../../../../data/kanto_hokkaido.csv",t=>{let e=((t,e=3)=>{if(null==t)return[];let s=[];const i=t.split("\n");for(let t=0;t<i.length;t++)s[t]=i[t].split(",");return s})(t.result);this.doSomething(e)})}doSomething(t){this.DATAisOK=!0,this.data=t,console.log(this.data[0][0])}update(){if(1==this.DATAisOK)if(this.frame<1800){if(this.frame+=1,this.frame%4==0)for(var t in this.meshes)this.checkIntersection(t)}else this.frame=1801}}class ft extends O.Scene{constructor(){super(),this.resetCamTargetBool=this.resetCamTargetBool.bind(this),this.openCamTargetBool=this.openCamTargetBool.bind(this),this.chooseRoom=this.chooseRoom.bind(this),this.camera=new ct,this.baseCamTarget=new O.Vector3(-200,70,400),this.scene0=new yt,this.add(this.scene0),this.frameBool_skipAnime=!0,this.camTargetBool_openingIsEnd=!1,this.resetCamTargetBool(),this.camTargetBool_BACKSPACE=!1,this.selectVRorNot=!1}update(){1==this.scene0.scene2.openingIsEnd&&(console.log("Opening is end and select VR or not"),this.scene0.scene2.openingIsEnd=!1,this.camTargetBool_openingIsEnd=!0),this.camera.update(),this.scene0.update()}onKeyUp(t){t.keyCode==W&&1==this.frameBool_skipAnime&&this.scene0.scene2.frame<this.scene0.scene2.frameSlide-1&&(this.frameBool_skipAnime=!1,this.camera.frame=this.scene0.scene2.frameSlide-1,this.scene0.scene2.frame=this.scene0.scene2.frameSlide-1,console.log("skip animasion !")),t.keyCode==K&&1==this.camTargetBool_openingIsEnd&&(this.camTargetBool_openingIsEnd=!1,this.camera.camTarget=this.baseCamTarget,this.camera.lookTarget=new O.Vector3(140,70,140),console.log("show 7 panels!"),this.openCamTargetBool()),t.keyCode==H&&this.chooseRoom(this.camTargetBool_A,0,"Go to room_A!"),t.keyCode==$&&this.chooseRoom(this.camTargetBool_B,1,"Go to room_B!"),t.keyCode==N&&this.chooseRoom(this.camTargetBool_C,3,"Go to room_C!"),t.keyCode==q&&this.chooseRoom(this.camTargetBool_D,4,"Go to room_D!"),t.keyCode==J&&this.chooseRoom(this.camTargetBool_E,6,"Go to room_E!"),t.keyCode==X&&this.chooseRoom(this.camTargetBool_F,7,"Go to room_F!"),t.keyCode==Z&&this.chooseRoom(this.camTargetBool_G,9,"Go to room_G!"),t.keyCode==Q&&1==this.camTargetBool_BACKSPACE&&(this.camTargetBool_BACKSPACE=!1,this.camera.camTarget=this.baseCamTarget,this.camera.lookTarget=new O.Vector3(140,70,140),console.log("Back to 7 panels!"),this.openCamTargetBool())}chooseRoom(t,e,s){1==t&&(t=!1,this.camera.lookTarget=new O.Vector3(25*(1.5+e),8+15*e,25*(1.5+e)),this.baseCamTarget=new O.Vector3(-200,70,400),this.camera.camTarget.subVectors(this.camera.lookTarget,this.baseCamTarget),this.camera.camTarget.multiplyScalar(.9),this.camera.camTarget.add(this.baseCamTarget),console.log(s),this.resetCamTargetBool())}resetCamTargetBool(){this.camTargetBool_BACKSPACE=!0,this.camTargetBool_A=!1,this.camTargetBool_B=!1,this.camTargetBool_C=!1,this.camTargetBool_D=!1,this.camTargetBool_E=!1,this.camTargetBool_F=!1,this.camTargetBool_G=!1}openCamTargetBool(){this.camTargetBool_BACKSPACE=!1,this.camTargetBool_A=!0,this.camTargetBool_B=!0,this.camTargetBool_C=!0,this.camTargetBool_D=!0,this.camTargetBool_E=!0,this.camTargetBool_F=!0,this.camTargetBool_G=!0}}class yt extends O.Scene{constructor(){super(),this.scene1=new bt,this.add(this.scene1),this.scene2=new _t,this.add(this.scene2)}update(){this.scene1.update(),this.scene2.update()}}class bt extends O.Scene{constructor(){super(),this._line=[this._line1in,this._line1out];for(let t=0;t<this._line.length/2;t++)for(let e=0;e<2;e++)this._line[2*t+e]=new ut(t,e),e%2==0?this._line[2*t+e].position.set(0,0,0):this._line[2*t+e].position.set(150,70,150),this.add(this._line[2*t+e])}setup(){}update(){for(let t=0;t<this._line.length;t++)this._line[t].update()}}class _t extends O.Scene{constructor(){super(),this.frame=0,this.frameSlide=1260,this.meshList=[],this.meshGroup=new O.Group;const t=new O.MeshBasicMaterial({color:16777215,wireframe:!0,opacity:.95,transparent:!0});this.PlateNum=320,this.positions=[],this.posTarget=[];for(let e=0;e<this.PlateNum;e++)this.floorsize=27,this.geometry=new O.PlaneBufferGeometry(this.floorsize,this.floorsize),this.mesh=new O.Mesh(this.geometry,t),this.mesh.position.set(0,0,0),this.mesh.rotation.x=90*Math.PI/180,this.meshGroup.add(this.mesh),this.meshList.push(this.mesh),this.positions.push(this.mesh.position.x,this.mesh.position.y,this.mesh.position.z),this.posTarget.push(0,0,0);this.add(this.meshGroup),this.clock=new O.Clock,this.tSpeed=2,this.easeElapsedTime=0,this.eansingBool=!0,this.openingIsEnd=!1}update(){if(this.frame<1800?this.frame+=1:(this.frame=1800,this.eansingBool),1==this.eansingBool){this.easeElapsedTime+=this.clock.getDelta(),this.t=this.easeElapsedTime/this.tSpeed,this.t>1&&(this.t=1),this.rate=this.t*this.t*(3-2*this.t);for(let t=0;t<this.meshList.length;t++){this.meshList[t].position.x=this.positions[3*t+0],this.meshList[t].position.y=this.positions[3*t+1],this.meshList[t].position.z=this.positions[3*t+2];for(let e=0;e<3;e++){let s=this.positions[3*t+e],i=this.posTarget[3*t+e];this.positions[3*t+e]=s*(1-this.rate)+i*this.rate}}}if(50==this.frame){for(let t=0;t<this.meshList.length;t++)for(let e=0;e<4;e++)t>=80*e&&t<80*(e+1)&&(this.posTarget[3*t+0]=25*e,this.posTarget[3*t+1]=0,this.posTarget[3*t+2]=0);this.easeElapsedTime=0,this.tSpeed=3}if(100==this.frame){for(let t=0;t<this.meshList.length;t++)for(let e=0;e<4;e++)if(t>=80*e&&t<80*(e+1))for(let s=0;s<4;s++)t>=80*e+20*s&&t<80*e+20*(s+1)&&(this.posTarget[3*t+0]=25*e,this.posTarget[3*t+1]=0,this.posTarget[3*t+2]=25*s);this.easeElapsedTime=0}if(150==this.frame){for(let t=0;t<this.meshList.length;t++)for(let e=0;e<4;e++)if(t>=80*e&&t<80*(e+1))for(let s=0;s<4;s++)if(t>=80*e+20*s&&t<80*e+20*(s+1))for(let i=0;i<20;i++)t>=80*e+20*s+1*i&&t<80*e+20*s+1*(i+1)&&(this.posTarget[3*t+0]=20*e,this.posTarget[3*t+1]=7*i,this.posTarget[3*t+2]=20*s);this.easeElapsedTime=0,this.tSpeed=3}if(230==this.frame){for(let t=0;t<this.meshList.length;t++)for(let e=0;e<4;e++)if(t>=80*e&&t<80*(e+1))for(let s=0;s<4;s++)if(t>=80*e+20*s&&t<80*e+20*(s+1))for(let i=0;i<10;i++)t>=80*e+20*s+2*i&&t<80*e+20*s+2*(i+1)&&(this.posTarget[3*t+0]=45*s,this.posTarget[3*t+1]=10*i,this.posTarget[3*t+2]=45*e);this.easeElapsedTime=0,this.tSpeed=3}if(310==this.frame){for(let t=0;t<this.meshList.length;t++)for(let e=0;e<4;e++)if(t>=80*e&&t<80*(e+1))for(let s=0;s<4;s++)if(t>=80*e+20*s&&t<80*e+20*(s+1))for(let i=0;i<10;i++)t>=80*e+20*s+2*i&&t<80*e+20*s+2*(i+1)&&(this.posTarget[3*t+0]=45*e,this.posTarget[3*t+1]=0,this.posTarget[3*t+2]=45*s);this.easeElapsedTime=0,this.tSpeed=3}if(360==this.frame){for(let t=0;t<this.meshList.length;t++)for(let e=0;e<4;e++)if(t>=80*e&&t<80*(e+1))for(let s=0;s<4;s++)if(t>=80*e+20*s&&t<80*e+20*(s+1))for(let i=0;i<10;i++)t>=80*e+20*s+2*i&&t<80*e+20*s+2*(i+1)&&(this.posTarget[3*t+0]=30*e,this.posTarget[3*t+1]=0,this.posTarget[3*t+2]=30*s);this.easeElapsedTime=0,this.tSpeed=3}if(410==this.frame){for(let t=0;t<this.meshList.length;t++)for(let e=0;e<8;e++)if(t>=40*e&&t<40*(e+1))for(let s=0;s<8;s++)if(t>=40*e+5*s&&t<40*e+5*(s+1))for(let i=0;i<5;i++)t>=40*e+5*s+1*i&&t<40*e+5*s+1*(i+1)&&(this.posTarget[3*t+0]=15*e,this.posTarget[3*t+1]=0,this.posTarget[3*t+2]=15*s);this.easeElapsedTime=0,this.tSpeed=3}if(460==this.frame&&(this.frame+=320),780==this.frame){for(let t=0;t<this.meshList.length;t++)for(let e=0;e<8;e++)if(t>=40*e&&t<40*(e+1))for(let s=0;s<8;s++)if(t>=40*e+5*s&&t<40*e+5*(s+1))for(let i=0;i<5;i++)t>=40*e+5*s+1*i&&t<40*e+5*s+1*(i+1)&&(this.posTarget[3*t+0]=70*Math.sin(2*t*Math.PI/180)+50,this.posTarget[3*t+1]=25,this.posTarget[3*t+2]=70*Math.cos(2*t*Math.PI/180)+50);this.easeElapsedTime=0,this.tSpeed=5}if(880==this.frame){for(let t=0;t<this.meshList.length;t++)for(let e=0;e<4;e++)if(t>=80*e&&t<80*(e+1))for(let s=0;s<4;s++)if(t>=80*e+20*s&&t<80*e+20*(s+1))for(let i=0;i<10;i++)t>=80*e+20*s+2*i&&t<80*e+20*s+2*(i+1)&&(this.posTarget[3*t+0]=20*s+50,this.posTarget[3*t+1]=1.5*i+25,this.posTarget[3*t+2]=4*e+50);this.easeElapsedTime=0,this.tSpeed=4}if(960==this.frame){for(let t=0;t<this.meshList.length;t++)for(let e=0;e<4;e++)if(t>=80*e&&t<80*(e+1))for(let s=0;s<4;s++)if(t>=80*e+20*s&&t<80*e+20*(s+1))for(let i=0;i<10;i++)t>=80*e+20*s+2*i&&t<80*e+20*s+2*(i+1)&&(this.posTarget[3*t+0]=70*Math.sin(4*t*Math.PI/180)+50,this.posTarget[3*t+1]=70*Math.cos(40*(e+s+i)*Math.PI/180)+25,this.posTarget[3*t+2]=-70*Math.sin(8*t*Math.PI/180)+50);this.easeElapsedTime=0,this.tSpeed=7}if(1080==this.frame){for(let t=0;t<this.meshList.length;t++)for(let e=0;e<4;e++)if(t>=80*e&&t<80*(e+1))for(let s=0;s<4;s++)if(t>=80*e+20*s&&t<80*e+20*(s+1))for(let i=0;i<10;i++)t>=80*e+20*s+2*i&&t<80*e+20*s+2*(i+1)&&(this.posTarget[3*t+0]=25*e,this.posTarget[3*t+1]=0,this.posTarget[3*t+2]=25*s);this.easeElapsedTime=0,this.tSpeed=4}if(1150==this.frame&&(this.frame+=50),1200==this.frame){for(let t=0;t<this.meshList.length;t++)for(let e=0;e<4;e++)if(t>=80*e&&t<80*(e+1))for(let s=0;s<4;s++)if(t>=80*e+20*s&&t<80*e+20*(s+1))for(let i=0;i<20;i++)t>=80*e+20*s+1*i&&t<80*e+20*s+1*(i+1)&&(this.posTarget[3*t+0]=20*e,this.posTarget[3*t+1]=5*i,this.posTarget[3*t+2]=20*s);this.easeElapsedTime=0,this.tSpeed=6}if(this.frame==this.frameSlide){for(let t=0;t<this.meshList.length;t++)for(let e=0;e<4;e++)if(t>=80*e&&t<80*(e+1))for(let s=0;s<4;s++)if(t>=80*e+20*s&&t<80*e+20*(s+1))for(let i=0;i<10;i++)t>=80*e+20*s+2*i&&t<80*e+20*s+2*(i+1)&&(this.posTarget[3*t+0]=25*(e+i),this.posTarget[3*t+1]=15*i,this.posTarget[3*t+2]=25*(s+i));this.easeElapsedTime=0,this.tSpeed=6}1370==this.frame&&0==this.openingIsEnd&&(this.openingIsEnd=!0)}}var wt={...U,props:{instance:null},init(){return this.props.instance=new lt(new ft),this},setup(){},update(){this.props.instance.update()},draw(){this.props.instance.draw()},destroy(){},onKeyUp(t){this.props.instance.onKeyUp(t)}},Ct=s(23),Tt=s(4);const vt={a:{categoryId:"A",categoryEn:"Architecture, Software",categoryJp:"アーキテクチャ・ソフトウェア",copy:"うごかすちから",imgPath:["./img/A01-sinetstream.png","./img/A02.png","./img/A03.png","./img/A04.png","./img/A05.png","./img/A06.png","./img/A07.png","./img/A08.png","./img/A10.png"],posterTitle:["ネットワークとクラウドを<br>活用してデータ収集から<br>解析まで","双方向化技術による<br>データベーススキーマの共存","サイエンスによる知的<br>ものづくり教育プログラム","プログラミング講義向け<br>Jupyter Notebook環境","Notebookで賢く運用！<br>NIIの研究クラウド","再構成可能デバイスを<br>使いやすくする研究","漸進的型付け: <br>安全性と柔軟性を<br>両立するプログラミング言語","不具合局所化のための<br>プログラムスペクトルの<br>可視化ならびに分析","経路計画機能の<br>テスト・設定調整の<br>自動探索","適切な「ぼかし」で、<br>ソフトウェアの<br>複雑さに挑む"]},b:{categoryId:"B",categoryEn:"Computation, Logic, <br> Quantum information",categoryJp:"数理・論理・量子情報",copy:"考え方をかんがえる",imgPath:["./img/B01.png","./img/B02.png","./img/B03.png","./img/B04.png","./img/B05.png","./img/B06.png","./img/B07.png","./img/B08.png"],posterTitle:["理論計算機科学入門： <br>有限と無限のあいだ <br>~ オートマトン理論を例に","量子の世界に潜むスケール<br>フリーネットワーク","計算量理論と暗号の安全性","Inner-iteration preconditioned <br>block GMRES","ネットワークにおける頂点の<br>重要度の感度解析","口コミ効果の最大化:<br>やってみよう!<br>ゲーム Infomania","食品価格の時系列表現の<br>形式化","数学からソフトウェア、<br>そしてものづくりへ"]},c:{categoryId:"C",categoryEn:"Artificial intelligence",categoryJp:"人工知能",copy:"計算機に思考させる",imgPath:["./img/C01.png","./img/C02.png","./img/C03.png","./img/C04.png","./img/C05.png","./img/C06.png","./img/C07.png","./img/C08.png","./img/C09.png","./img/C10.png"],posterTitle:["医療ビッグデータクラウド<br>基盤構築とAI画像解析研究","知識表現・推論と機械学習を統合<br>したロバストAI","コンピュータが法律推論？","機械読解における<br>質問回答ペアの生成モデル","機械学習で知識発見","機械学習の幾何学的解釈","ロバストインテリジェンスを<br>社会的な課題解決に役立てる<br>ための応用技術に関する研究","クラウド型VRによる対話型<br>知能ロボットのオンライン競技会","視聴覚クロスモーダル検索のための<br>共同埋め込みの学習","自然言語処理の実社会応用"]},d:{categoryId:"D",categoryEn:"Visual, audio, media",categoryJp:"映像・音・メディア",copy:"みる・きく・はなす・さがす",imgPath:["./img/D01.png","./img/D02.png","./img/D03.png","./img/D04.png","./img/D05.png","./img/D06.png","./img/D07.png","./img/D08.png"],posterTitle:["情報学データ資源の共同利用","NTCIR Challenges","セマンティック画像生成","実空間と整合する３次元映像<br>メディアに向けた光線情報符号化","ROIS-DS人文学オーブンデータ<br>共同利用センター","デッサン時の視線解析に<br>基づく物体の質感構成要素<br>の抽出","記憶に残る鑑賞体験のための<br>ガイドアプリ：みんぱく<br>ガイド@国立民族学博物館","テレビアーカイブを用いた<br>視聴者の行動センシング"]},e:{categoryId:"E",categoryEn:"Network, security",categoryJp:"ネットワーク・セキュリティ",copy:"安心につながる",imgPath:["./img/E01.png","./img/E02.png","./img/E03.png","./img/E04.png","./img/E05.png","./img/E06.png"],posterTitle:["ネットワーク事前知識を<br>活用したSINETログ<br>データの因果解析","サブ6GHz及びミリ波帯を<br>共用するBeyond 5G<br>ネットワークの為の<br>深層強化学習を活用した<br>アクセスポイント選択法","時空間深層学習モデルによる<br>ネットワークトラフィックの補間推定","マルチメディアセキュリティ・<br>プライバシー","Deepfake Detection and <br>Segmentation","Gait Anonymization Using <br>Deep Learning"]},f:{categoryId:"F",categoryEn:"Society and information",categoryJp:"社会と情報",copy:"サイバー世界と<br>フィジカル世界の融合",imgPath:["./img/F01.png","./img/F02.png","./img/F03.png","./img/F04.png","./img/F05.png","./img/F06.png","./img/F07.png","./img/F08.png","./img/F09.png"],posterTitle:["ブロックチェーンの登場で<br>社会はどう変化するのか？","","ソフトウェア工学からみた<br>機械学習","新型コロナウイルス感染症<br>対策への位置情報ビッグ<br>データの応用","ネットワーク投票力指数：<br>株式保有ネットワークに<br>おける間接的支配の測定","過積載を見逃さない道路橋","料理レシピ：カーボンフット<br>プリントを改善するには？","Flavorlens 2.0","Early stress detection and <br>absenteeism reduction"]},s:{categoryId:"特別展示",categoryEn:"Special Exhibition",categoryJp:"サービス・事業含む",copy:"",imgPath:["./img/S01.png","./img/S02.png","./img/S03.png","./img/S04.png"],posterTitle:["湘南会議","国立情報学研究所の<br>広報活動を紹介","情報学専攻の概要紹介と<br>入試案内","学術情報基盤の整備"]}};class xt{constructor(t,e){this.posterData=vt,this.currentCategory=null,this.categoryId=t,this.id=e,this.imgTexture=null,this.canvasTexture=null,this.boardWidth=80,this.boardHeight=45,this.fontSize=6,this.categories=vt.categories}setup(){switch(this.categoryId){case"a":this.currentCategory=this.posterData.a;break;case"b":this.currentCategory=this.posterData.b;break;case"c":this.currentCategory=this.posterData.c;break;case"d":this.currentCategory=this.posterData.d;break;case"e":this.currentCategory=this.posterData.e;break;case"f":this.currentCategory=this.posterData.f;break;default:this.currentCategory=this.posterData.s}}loadTexture(){const t=new O.TextureLoader;return this.imgTexture=t.load(this.currentCategory.imgPath[this.id]),this.imgTexture}createLabel(){const t=this.currentCategory.posterTitle[this.id],e=document.createElement("canvas");e.width=8*this.boardWidth,e.height=8*this.boardHeight;const s=e.getContext("2d");s.scale(8,8),s.font=this.fontSize+"px Arial, meiryo, sans-serif",s.fillStyle="rgba(255,255,255,1)";const i=t.split("<br>"),o=1.4*s.measureText("あ").width;return i.forEach((function(t,e){s.fillText(t,0,10+o*e)})),this.canvasTexture=new O.Texture(e),this.canvasTexture.needsUpdate=!0,this.canvasTexture}createCategory(t){const e=[];return this.posterData.forIn((t,s,i)=>{e[i]={},e[i].cateroryId=s.categoryId,e[i].categoryEn=s.categoryEn,e[i].categoryJp=s.categoryJp,e[i].copy=s.copy}),e}}class Bt extends class{constructor(t,e){this.texture=e||{},this.scene=t,this.boardWidth=80,this.boardHeight=45,this.imageGeometry,this.imageMaterial,this.imageShape=null,this.imagePosition=new O.Vector3,this.labelGeometry,this.labelMaterial,this.labelShape=null,this.labelPosition=new O.Vector3,this.wireGeometry,this.wireMaterial,this.wireShape=null,this.group=new O.Object3D,this.position=new O.Vector3}setup(){return this.scene.add(this.group),this}update(){null!=this.group&&this.draw()}draw(){}destroy(){this.scene.remove(this.group)}getScene(){return this.scene}}{constructor(t,e){super(t,e),this.imageGeometry=new O.PlaneGeometry(this.boardWidth,this.boardHeight),this.imageMaterial=new O.MeshBasicMaterial({color:16777215,map:this.texture.image,transparent:!0,opacity:0}),this.imageShape=new O.Mesh(this.imageGeometry,this.imageMaterial),this.group.add(this.imageShape),this.labelGeometry=new O.PlaneGeometry(this.boardWidth,this.boardHeight),this.labelMaterial=new O.MeshBasicMaterial({map:this.texture.label,transparent:!0,opacity:0}),this.labelShape=new O.Mesh(this.labelGeometry,this.labelMaterial),this.labelShape.position.y=-45,this.group.add(this.labelShape),this.wireGeometry=new O.WireframeGeometry(this.imageGeometry),this.wireMaterial=new O.LineBasicMaterial({color:16777215,transparent:!0,opacity:0}),this.wireShape=new O.LineSegments(this.wireGeometry,this.wireMaterial),this.group.add(this.wireShape)}}class Et{constructor(t,e,s=1){this.id=s,this.scene=t.getScene(),this.view=t,this.model=e,this.addEvent()}update(){this.view.update()}shapeChange(){}addEvent(){}}class kt{constructor(t,e,s=1){this.id=s,this.scene=t,this.model=new xt(e,this.id),this.model.setup();const i={image:this.model.loadTexture(),label:this.model.createLabel()};this.view=new Bt(this.scene,i).setup(),this.controller=new Et(this.view,this.model,this.id)}}class St{constructor(t,e){this.stage=t,this.categoryData=e}setup(){this.categoryWrapper=this.createDomElement("div","category-wrapper"),this.stage.appendChild(this.categoryWrapper);const t=document.createElement("ul");this.categoryWrapper.appendChild(t);const e=[];for(let s=0;s<this.categoryData.length;s++){e[s]=document.createElement("li"),t.appendChild(e[s]);const i=this.createDomElement("div","category-container cat"+s);e[s].appendChild(i);const o=this.createDomElement("div","caterory-label",this.categoryData[s].categoryId);i.appendChild(o);const a=this.createDomElement("div","categoryEn",this.categoryData[s].categoryEn);i.appendChild(a);const r=this.createDomElement("div","categoryJp",this.categoryData[s].categoryJp);i.appendChild(r);const n=this.createDomElement("div","categoryCopy",this.categoryData[s].copy);i.appendChild(n)}setTimeout(()=>{this.categoryWrapper.classList.add("fadein")},1e3)}update(){this.draw()}draw(){}destroy(){this.categoryWrapper.classList.remove("fadein"),setTimeout(()=>{this.stage.removeChild(this.categoryWrapper)},1e3)}getScene(){return this.stage}createDomElement(t,e,s){const i=document.createElement(t);if(s){i.setAttribute("class",e);const t=document.createTextNode(s);i.appendChild(t)}else i.setAttribute("class",e);return i}}class Pt{constructor(t){this.stage=t,this.categoryId=null,this.id=null,this.model=new xt(this.categoryId,this.id),this.model.setup();const e=this.model.createCategory();this.view=new St(this.stage,e),this.view.setup()}}class Lt{constructor(){}init(){this.setup(),this.createScene(),this.createCamera(),this.addOrbitControls(),this.addAmbientLight(),this.addDirectionalLight(),this.addCategory()}setup(){this.backgroundColor="#000000",this.width=window.innerWidth,this.height=window.innerHeight,this.mouse3D=new O.Vector2,this.meshList=[],this.raycaster=new O.Raycaster,this.rayReceiveObjects=[],this.posterData=vt.a,this.boardLength=this.posterData.imgPath.length,this.boardPosRadius=150;this.boardAngle=180/this.boardLength,this.halfAngle=180+this.boardAngle}draw(){this.raycaster.setFromCamera(this.mouse3D,this.camera);const t=this.raycaster.intersectObjects(this.rayReceiveObjects);this.rayReceiveObjects.map(e=>{t.length>0&&e===t[0].object?e.material.color.setHex(16777215):e.material.color.setHex(2236962)}),this.controls.update(),Tt.a.update(),this.renderer.render(this.scene,this.camera)}onMouseMove({clientX:t,clientY:e}){this.mouse3D.x=t/this.width*2-1,this.mouse3D.y=-e/this.height*2+1}onResize(){this.width=window.innerWidth,this.height=window.innerHeight,this.camera.aspect=this.width/this.height,this.camera.updateProjectionMatrix(),this.renderer.setSize(this.width,this.height)}onClick(t){const e=this.raycaster.intersectObjects(this.rayReceiveObjects);if(e.length>0){const t=e[0].object.name;console.dir(t),document.dispatchEvent(new CustomEvent(l.ShowDetail,{detail:{message:"Please show me a detail!"}}))}}addCategory(){const t=document.getElementById("category_stage");this.category=new Pt(t)}addBorad(){const t=new O.Vector3(0,30,0),e=new O.Vector3(0,-50,0);for(let s=0;s<this.boardLength;s++){let i;this.board=new kt(this.scene,"a",s),s%2==0?(this.board.view.group.position.y=40,i=t):(this.board.view.group.position.y=-50,i=e),this.board.view.group.position.set(this.boardPosRadius*Math.cos(O.Math.degToRad(s*this.boardAngle+this.halfAngle)),this.board.view.group.position.y,this.boardPosRadius*Math.sin(O.Math.degToRad(s*this.boardAngle+this.halfAngle))),this.board.view.group.lookAt(i),this.meshList.push(this.board),this.meshList[s].view.imageShape.name="poster"+s,this.rayReceiveObjects.push(this.meshList[s].view.imageShape)}this.setBoardAnime()}setBoardAnime(){for(let t=0;t<this.boardLength;t++){const e={x:this.meshList[t].view.group.position.x,y:this.meshList[t].view.group.position.y-100,z:this.meshList[t].view.group.position.z,alpha:this.meshList[t].view.imageMaterial.opacity},s={x:e.x,y:this.meshList[t].view.group.position.y,z:e.z,alpha:1},i=new Tt.a.Tween(e).to(s,500).easing(Tt.a.Easing.Cubic.InOut).onUpdate(()=>{this.meshList[t].view.group.position.x=e.x,this.meshList[t].view.group.position.y=e.y,this.meshList[t].view.group.position.z=e.z,this.meshList[t].view.labelMaterial.opacity=o.alpha,this.meshList[t].view.imageMaterial.opacity=o.alpha,this.meshList[t].view.wireMaterial.opacity=e.alpha}).delay(1e3+50*t).start(),o={alphaA:0,alphaB:1},a={alphaA:1,alphaB:0},r=new Tt.a.Tween(o).to(a,300).easing(Tt.a.Easing.Cubic.InOut).onUpdate(()=>{this.meshList[t].view.imageMaterial.opacity=o.alphaA,this.meshList[t].view.labelMaterial.opacity=o.alphaA}).delay(1e3+10*t);i.chain(r);new Tt.a.Tween(o).to(a,300).easing(Tt.a.Easing.Cubic.InOut).onUpdate(()=>{this.meshList[t].view.wireMaterial.opacity=o.alphaB}).delay(3e3+20*t).start()}}removeBoard(){}createScene(){this.scene=new O.Scene,this.renderer=new O.WebGLRenderer({antialias:!0,alpha:!0}),this.renderer.setSize(window.innerWidth,window.innerHeight),this.renderer.setPixelRatio(window.devicePixelRatio),this.renderer.setClearColor(this.backgroundColor),this.renderer.shadowMap.enabled=!0,this.renderer.shadowMap.type=O.PCFSoftShadowMap,this.renderer.autoClear=!1,document.getElementById(g).appendChild(this.renderer.domElement)}createCamera(){this.camera=new O.PerspectiveCamera(60,window.innerWidth/window.innerHeight,1),this.camera.position.set(0,80,150),this.camera.lookAt(new O.Vector3(0,50,-80)),this.scene.add(this.camera)}addOrbitControls(){this.controls=new Ct.a(this.camera,this.renderer.domElement),this.controls.minPolarAngle=0,this.controls.maxPolarAngle=Math.PI,this.controls.minDistance=0,this.controls.maxDistance=1/0,this.enableZoom=!0,this.zoomSpeed=1,this.controls.enablePan=!0}addAmbientLight(){const t=new O.AmbientLight(4210752,1);this.scene.add(t)}addDirectionalLight(){const t=new O.DirectionalLight(16777215,1);t.position.set(0,300,30),this.scene.add(t)}}var Mt={...U,props:{instance:null},init(){return this.props.instance=new Lt,this.props.instance.init(),this},setup(){},update(){},draw(){this.props.instance.draw()},destroy(){},onResize(){this.props.instance.onResize()},onMouseMove(t){this.props.instance.onMouseMove(t)},onClick(t){this.props.instance.onClick(t)}},At=s(24),It=function(t){O.Object3D.call(this),this.element=t,this.element.style.position="absolute",this.element.style.pointerEvents="auto",this.addEventListener("removed",(function(){this.traverse((function(t){t.element instanceof Element&&null!==t.element.parentNode&&t.element.parentNode.removeChild(t.element)}))}))};(It.prototype=Object.create(O.Object3D.prototype)).constructor=It;var Dt=function(t){It.call(this,t)};(Dt.prototype=Object.create(It.prototype)).constructor=Dt;var jt=function(){var t,e,s,i,o=new O.Matrix4,a={camera:{fov:0,style:""},objects:new WeakMap},r=document.createElement("div");r.style.overflow="hidden",this.domElement=r;var n=document.createElement("div");n.style.WebkitTransformStyle="preserve-3d",n.style.transformStyle="preserve-3d",n.style.pointerEvents="none",r.appendChild(n);var h=/Trident/i.test(navigator.userAgent);function l(t){return Math.abs(t)<1e-10?0:t}function c(t){var e=t.elements;return"matrix3d("+l(e[0])+","+l(-e[1])+","+l(e[2])+","+l(e[3])+","+l(e[4])+","+l(-e[5])+","+l(e[6])+","+l(e[7])+","+l(e[8])+","+l(-e[9])+","+l(e[10])+","+l(e[11])+","+l(e[12])+","+l(-e[13])+","+l(e[14])+","+l(e[15])+")"}function d(t,e){var o=t.elements,a="matrix3d("+l(o[0])+","+l(o[1])+","+l(o[2])+","+l(o[3])+","+l(-o[4])+","+l(-o[5])+","+l(-o[6])+","+l(-o[7])+","+l(o[8])+","+l(o[9])+","+l(o[10])+","+l(o[11])+","+l(o[12])+","+l(o[13])+","+l(o[14])+","+l(o[15])+")";return h?"translate(-50%,-50%)translate("+s+"px,"+i+"px)"+e+a:"translate(-50%,-50%)"+a}this.getSize=function(){return{width:t,height:e}},this.setSize=function(o,a){s=(t=o)/2,i=(e=a)/2,r.style.width=o+"px",r.style.height=a+"px",n.style.width=o+"px",n.style.height=a+"px"};var m,p,g=(m=new O.Vector3,p=new O.Vector3,function(t,e){return m.setFromMatrixPosition(t.matrixWorld),p.setFromMatrixPosition(e.matrixWorld),m.distanceToSquared(p)});function u(t){for(var e=function(t){var e=[];return t.traverse((function(t){t instanceof It&&e.push(t)})),e}(t).sort((function(t,e){return a.objects.get(t).distanceToCameraSquared-a.objects.get(e).distanceToCameraSquared})),s=e.length,i=0,o=e.length;i<o;i++)e[i].element.style.zIndex=s-i}this.render=function(t,e){var m=e.projectionMatrix.elements[5]*i;if(a.camera.fov!==m&&(e.isPerspectiveCamera?(r.style.WebkitPerspective=m+"px",r.style.perspective=m+"px"):(r.style.WebkitPerspective="",r.style.perspective=""),a.camera.fov=m),!0===t.autoUpdate&&t.updateMatrixWorld(),null===e.parent&&e.updateMatrixWorld(),e.isOrthographicCamera)var p=-(e.right+e.left)/2,f=(e.top+e.bottom)/2;var y=e.isOrthographicCamera?"scale("+m+")translate("+l(p)+"px,"+l(f)+"px)"+c(e.matrixWorldInverse):"translateZ("+m+"px)"+c(e.matrixWorldInverse),b=y+"translate("+s+"px,"+i+"px)";a.camera.style===b||h||(n.style.WebkitTransform=b,n.style.transform=b,a.camera.style=b),function t(e,s,i){if(e instanceof It){var r;e instanceof Dt?(o.copy(s.matrixWorldInverse),o.transpose(),o.copyPosition(e.matrixWorld),o.scale(e.scale),o.elements[3]=0,o.elements[7]=0,o.elements[11]=0,o.elements[15]=1,r=d(o,i)):r=d(e.matrixWorld,i);var l=e.element,c=a.objects.get(e);if(void 0===c||c.style!==r){l.style.WebkitTransform=r,l.style.transform=r;var m={style:r};h&&(m.distanceToCameraSquared=g(s,e)),a.objects.set(e,m)}l.parentNode!==n&&n.appendChild(l)}for(var p=0,u=e.children.length;p<u;p++)t(e.children[p],s,i)}(t,e,y),h&&u(t)}};class zt{constructor(t,e,s,i,o){var a=document.createElement("div");a.style.width="800px",a.style.height="450px";var r=document.createElement("iframe");r.style.width="800px",r.style.height="450px",r.style.border="0px",r.src=t,a.appendChild(r);var n=new It(a);return n.position.set(e,s,i),n.rotation.y=o,n}}const Rt=window.pdfjsLib;class Vt{constructor(t,e,s,i){this.room_id="a07";var o=document.createElement("canvas");o.width=800,o.height=500;var a=o.getContext("2d");Rt.getDocument(`./pdf/${this.room_id}.pdf`).promise.then((function(t){var e;e=1,t.getPage(e).then((function(t){var e=t.getViewport({scale:800/720}),s={canvasContext:a,viewport:e};t.render(s).promise.then((function(){console.log("Page rendered")}))}))}));var r=new It(o);return r.position.set(t,e,s),r.rotation.y=i,r}}var Gt={props:{isEnable:!1},init(){let{camera:t,scene:e,renderer:s,controls:i}=this.props;var o=document.getElementById(f);t=new O.PerspectiveCamera(50,window.innerWidth/window.innerHeight,1,5e3),t.position.set(0,0,2e3),e=new O.Scene,s=new jt,s.setSize(window.innerWidth,window.innerHeight),o.appendChild(s.domElement);var a=new O.Group;a.add(new Vt(0,300,450,0)),a.add(new zt("https://www.youtube.com/embed/G9AtkiCESAg",1e3,0,0,-Math.PI/8)),a.add(new zt("https://www.youtube.com/embed/9PVjlAm-A1A",-1e3,0,0,Math.PI/8)),a.add(new zt("https://salty-waters-60310.herokuapp.com/a07",0,-300,450,0)),e.add(a),i=new At.a(t,s.domElement),i.rotateSpeed=4;var r=document.getElementById(y);r.style.display="none",i.addEventListener("start",(function(){r.style.display=""})),i.addEventListener("end",(function(){r.style.display="none"})),this.props={...this.props,camera:t,scene:e,renderer:s,controls:i},this.addEvent()},draw(){const{controls:t,renderer:e,scene:s,camera:i}=this.props;t.update(),e.render(s,i)},onResize(){const{controls:t,renderer:e,scene:s,camera:i}=this.props;i.aspect=window.innerWidth/window.innerHeight,i.updateProjectionMatrix(),e.setSize(window.innerWidth,window.innerHeight)},onKeyUp(t){t.keyCode===h&&this.hide()},addEvent(){document.addEventListener(l.ShowDetail,t=>this.show())},show(){const t=document.getElementById(u),e=document.getElementById(p);this.props.isEnable=!0,t.style.visibility="visible",e.style.visibility="hidden"},hide(){const t=document.getElementById(u),e=document.getElementById(p);this.props.isEnable=!1,t.style.visibility="hidden",e.style.visibility="visible"}};class Ut extends O.Scene{constructor(){super(),this.frame=1200,this.resetCamTargetBool=this.resetCamTargetBool.bind(this),this.openCamTargetBool=this.openCamTargetBool.bind(this),this.chooseRoom=this.chooseRoom.bind(this),this.baseCamTarget=new O.Vector3(-270,-55,-350),this.baseCamTargetPlus=new O.Vector3(270,55,350),this.camPos=new O.Vector3(0,-100,-240),this.camTarget=new O.Vector3(-140,0,-140),this.keyBool_startVRanime=!0,this.updateBool=!1,this.resetCamTargetBool(),this.camTargetBool_BACKSPACE=!1,this.show7panels=!1}setup(){}update(){1==this.updateBool&&(this.frame+=1,this.camPos.x+=.01*(this.camTarget.x-this.camPos.x),this.camPos.y+=.01*(this.camTarget.y-this.camPos.y),this.camPos.z+=.01*(this.camTarget.z-this.camPos.z),this.scene0.position.set(this.camPos.x,this.camPos.y,this.camPos.z),350==this.frame&&(this.camTarget=new O.Vector3(-150,-100,-50)),700==this.frame&&(this.camTarget=new O.Vector3(-50,-25,-50)),1100==this.frame&&(this.camTarget=new O.Vector3(70,-80,-200)),this.scene0.rotation.y=45*Math.PI/180,this.scene0.update(),1==this.scene0.scene2.openingIsEnd&&(console.log("show 7 panels!"),this.camTarget=this.baseCamTarget,this.openCamTargetBool(),this.scene0.scene2.openingIsEnd=!1))}onKeyUp(t){t.keyCode==F&&1==this.keyBool_startVRanime&&(this.keyBool_startVRanime=!1,this.scene0=new Ot,this.add(this.scene0),this.updateBool=!0,console.log("start VR anime!")),t.keyCode==H&&this.chooseRoom(this.camTargetBool_A,0,"Go to room_A!"),t.keyCode==$&&this.chooseRoom(this.camTargetBool_B,1,"Go to room_B!"),t.keyCode==N&&this.chooseRoom(this.camTargetBool_C,3,"Go to room_C!"),t.keyCode==q&&this.chooseRoom(this.camTargetBool_D,4,"Go to room_D!"),t.keyCode==J&&this.chooseRoom(this.camTargetBool_E,6,"Go to room_E!"),t.keyCode==X&&this.chooseRoom(this.camTargetBool_F,7,"Go to room_F!"),t.keyCode==Z&&this.chooseRoom(this.camTargetBool_G,9,"Go to room_G!"),t.keyCode==Q&&1==this.camTargetBool_BACKSPACE&&(this.camTargetBool_BACKSPACE=!1,this.baseCamTarget=new O.Vector3(-270,-55,-350),this.camTarget=this.baseCamTarget,console.log("Please back to 7 panels!"),this.openCamTargetBool())}chooseRoom(t,e,s){1==t&&(t=!1,this.lookTarget=new O.Vector3(35.25*(1.5+e),8+15*e,0*(1.5+e)),this.camTarget.subVectors(this.lookTarget,this.baseCamTargetPlus),this.camTarget.multiplyScalar(.95),this.camTarget.add(this.baseCamTargetPlus),this.camTarget.multiplyScalar(-1),console.log(s),this.resetCamTargetBool())}resetCamTargetBool(){this.camTargetBool_BACKSPACE=!0,this.camTargetBool_A=!1,this.camTargetBool_B=!1,this.camTargetBool_C=!1,this.camTargetBool_D=!1,this.camTargetBool_E=!1,this.camTargetBool_F=!1,this.camTargetBool_G=!1}openCamTargetBool(){this.camTargetBool_BACKSPACE=!1,this.camTargetBool_A=!0,this.camTargetBool_B=!0,this.camTargetBool_C=!0,this.camTargetBool_D=!0,this.camTargetBool_E=!0,this.camTargetBool_F=!0,this.camTargetBool_G=!0}}class Ot extends O.Scene{constructor(){super(),this.scene1=new Wt,this.add(this.scene1),this.scene2=new Ft,this.add(this.scene2)}update(){this.scene1.update(),this.scene2.update()}}class Wt extends O.Scene{constructor(){super(),this._line=[this._line1in,this._line1out];for(let t=0;t<this._line.length/2;t++)for(let e=0;e<2;e++)this._line[2*t+e]=new ut(t,e),e%2==0?this._line[2*t+e].position.set(0,0,0):this._line[2*t+e].position.set(150,70,150),this.add(this._line[2*t+e])}update(){for(let t=0;t<this._line.length;t++)this._line[t].update()}}class Ft extends O.Scene{constructor(){super(),this.frame=1200,this.meshList=[],this.meshGroup=new O.Group;const t=new O.MeshBasicMaterial({color:13092807,wireframe:!0,opacity:.9,transparent:!0});this.PlateNum=320,this.positions=[],this.posTarget=[];for(let e=0;e<this.PlateNum;e++)this.floorsize=27,this.geometry=new O.PlaneBufferGeometry(this.floorsize,this.floorsize),this.mesh=new O.Mesh(this.geometry,t),this.mesh.position.set(0,0,0),this.mesh.rotation.x=90*Math.PI/180,this.meshGroup.add(this.mesh),this.meshList.push(this.mesh),this.positions.push(this.mesh.position.x,this.mesh.position.y,this.mesh.position.z),this.posTarget.push(0,0,0);this.clock=new O.Clock,this.tSpeed=2,this.easeElapsedTime=0,this.eansingBool=!0,this.add(this.meshGroup),this.openingIsEnd=!1}update(){if(this.frame+=1,1==this.eansingBool){this.easeElapsedTime+=this.clock.getDelta(),this.t=this.easeElapsedTime/this.tSpeed,this.t>1&&(this.t=1),this.rate=this.t*this.t*(3-2*this.t);for(let t=0;t<this.meshList.length;t++){this.meshList[t].position.x=this.positions[3*t+0],this.meshList[t].position.y=this.positions[3*t+1],this.meshList[t].position.z=this.positions[3*t+2];for(let e=0;e<3;e++){let s=this.positions[3*t+e],i=this.posTarget[3*t+e];this.positions[3*t+e]=s*(1-this.rate)+i*this.rate}}}if(50==this.frame){for(let t=0;t<this.meshList.length;t++)for(let e=0;e<4;e++)t>=80*e&&t<80*(e+1)&&(this.posTarget[3*t+0]=25*e,this.posTarget[3*t+1]=0,this.posTarget[3*t+2]=0);this.easeElapsedTime=0,this.tSpeed=3}if(110==this.frame){for(let t=0;t<this.meshList.length;t++)for(let e=0;e<4;e++)if(t>=80*e&&t<80*(e+1))for(let s=0;s<4;s++)t>=80*e+20*s&&t<80*e+20*(s+1)&&(this.posTarget[3*t+0]=25*e,this.posTarget[3*t+1]=0,this.posTarget[3*t+2]=25*s);this.easeElapsedTime=0}if(170==this.frame){for(let t=0;t<this.meshList.length;t++)for(let e=0;e<4;e++)if(t>=80*e&&t<80*(e+1))for(let s=0;s<4;s++)if(t>=80*e+20*s&&t<80*e+20*(s+1))for(let i=0;i<20;i++)t>=80*e+20*s+1*i&&t<80*e+20*s+1*(i+1)&&(this.posTarget[3*t+0]=25*e,this.posTarget[3*t+1]=7*i,this.posTarget[3*t+2]=25*s);this.easeElapsedTime=0,this.tSpeed=4}if(280==this.frame){for(let t=0;t<this.meshList.length;t++)for(let e=0;e<4;e++)if(t>=80*e&&t<80*(e+1))for(let s=0;s<4;s++)if(t>=80*e+20*s&&t<80*e+20*(s+1))for(let i=0;i<10;i++)t>=80*e+20*s+2*i&&t<80*e+20*s+2*(i+1)&&(this.posTarget[3*t+0]=45*s,this.posTarget[3*t+1]=10*i,this.posTarget[3*t+2]=45*e);this.easeElapsedTime=0,this.tSpeed=4}if(430==this.frame){for(let t=0;t<this.meshList.length;t++)for(let e=0;e<4;e++)if(t>=80*e&&t<80*(e+1))for(let s=0;s<4;s++)if(t>=80*e+20*s&&t<80*e+20*(s+1))for(let i=0;i<10;i++)t>=80*e+20*s+2*i&&t<80*e+20*s+2*(i+1)&&(this.posTarget[3*t+0]=45*e,this.posTarget[3*t+1]=0,this.posTarget[3*t+2]=45*s);this.easeElapsedTime=0,this.tSpeed=7}if(490==this.frame){for(let t=0;t<this.meshList.length;t++)for(let e=0;e<4;e++)if(t>=80*e&&t<80*(e+1))for(let s=0;s<4;s++)if(t>=80*e+20*s&&t<80*e+20*(s+1))for(let i=0;i<10;i++)t>=80*e+20*s+2*i&&t<80*e+20*s+2*(i+1)&&(this.posTarget[3*t+0]=30*e,this.posTarget[3*t+1]=0,this.posTarget[3*t+2]=30*s);this.easeElapsedTime=0,this.tSpeed=4}if(550==this.frame){for(let t=0;t<this.meshList.length;t++)for(let e=0;e<8;e++)if(t>=40*e&&t<40*(e+1))for(let s=0;s<8;s++)if(t>=40*e+5*s&&t<40*e+5*(s+1))for(let i=0;i<5;i++)t>=40*e+5*s+1*i&&t<40*e+5*s+1*(i+1)&&(this.posTarget[3*t+0]=15*e,this.posTarget[3*t+1]=0,this.posTarget[3*t+2]=15*s);this.easeElapsedTime=0,this.tSpeed=4}if(600==this.frame){for(let t=0;t<this.meshList.length;t++)for(let e=0;e<8;e++)if(t>=40*e&&t<40*(e+1))for(let s=0;s<8;s++)if(t>=40*e+5*s&&t<40*e+5*(s+1))for(let i=0;i<5;i++)t>=40*e+5*s+1*i&&t<40*e+5*s+1*(i+1)&&(this.posTarget[3*t+0]=20*e,this.posTarget[3*t+1]=30*Math.sin((30*(e+s)+2*(this.frame+60))*Math.PI/180),this.posTarget[3*t+2]=20*s);this.easeElapsedTime=0}if(660==this.frame&&(this.eansingBool=!1),this.frame>=660&&this.frame<780){for(let t=0;t<this.meshList.length;t++)this.meshList[t].position.x=this.positions[3*t+0],this.meshList[t].position.y=this.positions[3*t+1],this.meshList[t].position.z=this.positions[3*t+2];for(let t=0;t<this.meshList.length;t++)for(let e=0;e<8;e++)if(t>=40*e&&t<40*(e+1))for(let s=0;s<8;s++)if(t>=40*e+5*s&&t<40*e+5*(s+1))for(let i=0;i<5;i++)t>=40*e+5*s+1*i&&t<40*e+5*s+1*(i+1)&&(this.positions[3*t+0]=20*e,this.positions[3*t+1]=30*Math.sin((30*(e+s)+2*this.frame)*Math.PI/180),this.positions[3*t+2]=20*s)}if(780==this.frame&&(this.eansingBool=!0),780==this.frame){for(let t=0;t<this.meshList.length;t++)for(let e=0;e<8;e++)if(t>=40*e&&t<40*(e+1))for(let s=0;s<8;s++)if(t>=40*e+5*s&&t<40*e+5*(s+1))for(let i=0;i<5;i++)t>=40*e+5*s+1*i&&t<40*e+5*s+1*(i+1)&&(this.posTarget[3*t+0]=80*Math.sin(2*t*Math.PI/180)+50,this.posTarget[3*t+1]=25,this.posTarget[3*t+2]=80*Math.cos(2*t*Math.PI/180)+50);this.easeElapsedTime=0,this.tSpeed=30}if(900==this.frame){for(let t=0;t<this.meshList.length;t++)for(let e=0;e<4;e++)if(t>=80*e&&t<80*(e+1))for(let s=0;s<4;s++)if(t>=80*e+20*s&&t<80*e+20*(s+1))for(let i=0;i<10;i++)t>=80*e+20*s+2*i&&t<80*e+20*s+2*(i+1)&&(this.posTarget[3*t+0]=4*s+50,this.posTarget[3*t+1]=1.5*i+25,this.posTarget[3*t+2]=4*e+50);this.easeElapsedTime=0,this.tSpeed=8}if(1e3==this.frame){for(let t=0;t<this.meshList.length;t++)for(let e=0;e<4;e++)if(t>=80*e&&t<80*(e+1))for(let s=0;s<4;s++)if(t>=80*e+20*s&&t<80*e+20*(s+1))for(let i=0;i<10;i++)t>=80*e+20*s+2*i&&t<80*e+20*s+2*(i+1)&&(this.posTarget[3*t+0]=70*Math.sin(4*t*Math.PI/180)+50,this.posTarget[3*t+1]=70*Math.cos(40*(e+s+i)*Math.PI/180)+25,this.posTarget[3*t+2]=-70*Math.sin(8*t*Math.PI/180)+50);this.easeElapsedTime=0,this.tSpeed=12}if(1150==this.frame){for(let t=0;t<this.meshList.length;t++)for(let e=0;e<4;e++)if(t>=80*e&&t<80*(e+1))for(let s=0;s<4;s++)if(t>=80*e+20*s&&t<80*e+20*(s+1))for(let i=0;i<10;i++)t>=80*e+20*s+2*i&&t<80*e+20*s+2*(i+1)&&(this.posTarget[3*t+0]=25*e,this.posTarget[3*t+1]=0,this.posTarget[3*t+2]=25*s);this.easeElapsedTime=0,this.tSpeed=4}if(1270==this.frame){for(let t=0;t<this.meshList.length;t++)for(let e=0;e<4;e++)if(t>=80*e&&t<80*(e+1))for(let s=0;s<4;s++)if(t>=80*e+20*s&&t<80*e+20*(s+1))for(let i=0;i<20;i++)t>=80*e+20*s+1*i&&t<80*e+20*s+1*(i+1)&&(this.posTarget[3*t+0]=20*e,this.posTarget[3*t+1]=5*i,this.posTarget[3*t+2]=20*s);this.easeElapsedTime=0,this.tSpeed=4}if(1370==this.frame){for(let t=0;t<this.meshList.length;t++)for(let e=0;e<4;e++)if(t>=80*e&&t<80*(e+1))for(let s=0;s<4;s++)if(t>=80*e+20*s&&t<80*e+20*(s+1))for(let i=0;i<10;i++)t>=80*e+20*s+2*i&&t<80*e+20*s+2*(i+1)&&(this.posTarget[3*t+0]=25*(e+i),this.posTarget[3*t+1]=15*i,this.posTarget[3*t+2]=25*(s+i));this.easeElapsedTime=0,this.tSpeed=10}1470==this.frame&&0==this.openingIsEnd&&(this.openingIsEnd=!0)}}var Kt=window.AFRAME.registerComponent(k,{props:{},modules:{},init(){console.log("Background Component Init."),this.props.scene=this.el.object3D;const t=document.createElement("a-entity");t.setAttribute("id",c),this.props.container=this.el.appendChild(t),this.modules.scene=new Ut,this.modules.scene.setup(),setTimeout(()=>{this.props.container.object3D.add(this.modules.scene)},1e3)},tick(){this.modules.scene.update()},onKeyUp(t){null!=this.modules.scene&&this.modules.scene.onKeyUp(t)}});s(48);class Ht{constructor(t){this.params=t,this.index=t.index||0,this.name=t.name||t.boardID||"Board"+Date.now(),this.category=t.category,this.boardId=t.boardId||A,this.entities={board:null},this.width=12,this.height=.5625*this.width,this.position=new O.Vector3,this.rotation=new O.Vector3,this.scale=new O.Vector3(this.width,this.height,1),this.containers={board:document.getElementById(b),boardContent:null,boardContentBody:null,...t.containers},this.materials={board:"shader: html; color: #ccc; transparent: true; target: #"+this.name}}createBoard(t="board",e=this.containers.board,s=this.materials.board,i=!0){this.entities[t]=document.createElement("a-entity"),this.entities[t].setAttribute("geometry","primitive: plane"),this.entities[t].setAttribute("material",s),this.entities[t].setAttribute(M,""),i&&this.entities[t].setAttribute("class",C),this.entities[t].instance=this,e.appendChild(this.entities[t])}createContent(t="",e=this.containers.boardContent){const s=document.createElement("div");return s.setAttribute("id",""+this.name),s.insertAdjacentHTML("afterbegin",t),e.appendChild(s),s}draw(){this.entities.forIn((t,e)=>{e.setAttribute("position",this.position),e.setAttribute("rotation",this.rotation),e.setAttribute("scale",this.scale)})}destroy(){this.containers.board.removeChild(this.entities.board),null!=this.containers.boardContent&&null!=this.containers.boardContentBody&&this.containers.boardContent.removeChild(this.containers.boardContentBody),this.entities.board.destroy()}setPosition(t,e,s){this.position.set(t,e,s)}lookAt(t){null!=t&&t instanceof O.Vector3||(t=new O.Vector3);const e=180+180*Math.atan2(this.position.x-t.x,this.position.z-t.z)/Math.PI;this.rotation.set(0,e,0)}onRaycastForcedOn(t){}onRaycastForcedOff(t){}}class $t extends Ht{constructor(t){super(t),this.width=12,this.height=12,this.scale=new O.Vector3(this.width,this.height,1),this.init()}init(){let t='<div class="hud_ui">';switch(this.boardId){case j.ShowCategoryA:t+="A";break;case j.ShowCategoryD:t+="D";break;case j.ShowCategoryG:t+="G";break;case j.VRModeStart:t+="VR Mode Start";break;default:t+="BACK"}t+="</div>",this.containers.boardContentBody=this.createContent(t),this.createBoard()}}var Nt={init_base(t){this.scene=t,this.containers={hud:{back:null}},this.boardList=[],this.hudUIList=[]},init(t){this.init_base(t)},draw(){this.boardList.forEach(t=>t.draw()),this.hudUIList.forEach(t=>t.draw())},destroy(){this.boardList.forEach(t=>t.destroy()),this.hudUIList.forEach(t=>t.destroy())},generateContainer(t,e){const s=document.getElementById(t);if(null!=s)return s;const i=document.createElement("a-entity");return i.setAttribute("id",t),e.appendChild(i)},generateHUD(t=j.BackToCategory,e=[0,12,-20]){this.containers[t]=this.generateContainer(T,this.scene);const s=document.getElementById(d),i={boardId:t,containers:{board:this.containers[t],boardContent:s}},o=new $t(i);o.setPosition(...e),this.hudUIList.push(o)},showBoard(t,e=this.boardList,s=20,i=null){const o=e.length,a=null!=t?t+2:360/o;i=null==i?-90-(o-1)*a/2:i;for(let t=0;t<o;t++){const o=e[t],r=t*a+i;o.setPosition(s*Math.cos(O.Math.degToRad(r)),o.position.y,s*Math.sin(O.Math.degToRad(r))),o.lookAt()}}};class qt extends Ht{constructor(t){super(t),this.name="poster"+t.index,this.boardId=I,this.materials={board:"shader: flat; color: #999; src: "+t.containers.boardContentBody,title:"shader: html; color: #999; transparent: true; target: #"+this.name},this.entities={...this.entities,title:null},this.slug=this.category+(this.index<10?"0":"")+this.index,this.init()}init(){this.containers.titleContentBody=this.createContent(`\n    <div class="gallery_poster_title">${this.containers.titleContentBody}</div>\n    `,this.containers.titleContent),this.containers.title.object3D.position.set(0,-6.75,0),this.createBoard("title",this.containers.title,this.materials.title,!1),this.createBoard()}destroy(){super.destroy(),null!=this.containers.titleContentBody&&(this.containers.title.removeChild(this.entities.title),this.containers.titleContent.removeChild(this.containers.titleContentBody),this.entities.title.destroy())}onRaycastForcedOn(t){this.entities.title.object3DMap.mesh.material.color=new O.Color(1,1,1)}onRaycastForcedOff(t){this.entities.title.object3DMap.mesh.material.color=new O.Color(.6,.6,.6)}}class Jt extends Ht{constructor(t){super(t),this.width=12,this.height=this.width,this.scale=new O.Vector3(this.width,this.height,1),this.init()}init(){this.containers.boardContentBody=this.createContent((t=>{const e="abcdefs".substr(t.index,1),{categoryEn:s,categoryJp:i,copy:o}=t.data[e],a="s"===e?"特別展示":e.toUpperCase();return`\n\t\t<div class="category_content_container category_${e}">\n\t\t\t<div class="category_id">${a}</div>\n\t\t\t<div class="category_title english">${s}</div>\n\t\t\t<div class="category_title japanese">${i}</div>\n\t\t\t<div class="category_copy">${o}</div>\n\t\t</div>\n\t`})(this.params)),this.createBoard()}}var Xt={...Nt,init(t){this.init_base(t),this.containers={...this.containers,category:{board:null},poster:{panel:null,title:null}},this.currentCategory="",this.addEvent(),this.generateCategory(vt)},generatePosters(t=this.currentCategory){this.currentCategory=t,this.containers.poster.panel=this.generateContainer(x,this.scene),this.containers.poster.title=this.generateContainer(B,this.containers.poster.panel),this.containers.poster.titleContent=document.getElementById(g),this.boardList.length=0,this.hudUIList.length=0;const e=vt[t],s=e.imgPath.length;for(let i=0;i<s;i++){const s={index:i+1,name:"poster"+i,category:t,boardId:I,containers:{board:this.containers.poster.panel,boardContentBody:e.imgPath[i],title:this.containers.poster.title,titleContent:this.containers.poster.titleContent,titleContentBody:e.posterTitle[i]},data:e};this.boardList.push(new qt(s))}this.generateHUD(),this.showBoard(34)},generateHUDs(){this.generateHUD(j.BackToCategory,[0,12,0]),G(()=>{this.generateHUD(j.ShowCategoryA,[0,12,0],10)}),G(()=>{this.generateHUD(j.ShowCategoryD,[0,12,0],20)}),G(()=>{this.generateHUD(j.ShowCategoryG,[0,12,0],30)}),G(()=>{this.generateHUD(j.VRModeStart,[0,12,0],40)}),G(()=>{this.showBoard(34,this.boardList,20),this.showBoard(34,this.hudUIList,20,-150)},50)},generateCategory(t=vt){this.containers.category.board=this.generateContainer(v,this.scene),this.boardList.length=0,this.hudUIList.length=0;const e=document.getElementById(m),s=Object.keys(t),i=s.length;for(let o=0;o<i;o++){const i={index:o,name:"category"+o,category:s[o],boardId:A,containers:{board:this.containers.category.board,boardContent:e},data:t};this.boardList.push(new Jt(i))}this.generateHUDs()},addEvent(){r.add(a.ShowPoster,t=>{console.log("Category "+t),null!=t&&(this.destroy(),this.generatePosters(t))}),r.add(a.ShowDetail,()=>this.destroy()),r.add(a.BackToCategory,()=>{this.destroy(),this.generateCategory(vt)}),r.add(a.BackToPoster,()=>this.generatePosters())}};var Zt=window.AFRAME.registerComponent(S,{props:{},modules:{},init(){console.log("Gallery Component Init."),this.props.scene=this.el.object3D,this.props.container=this.el.appendChild(document.createElement("a-entity")),this.modules.gallery=Xt,this.modules.gallery.init(this.props.container)},tick(){null!=this.modules.gallery&&this.modules.gallery.draw()},onKeyUp(t){}});class Qt extends Ht{constructor(t){super(t),this.width=18,this.height=18,this.scale=new O.Vector3(this.width,this.height,1),this.materials={board:"shader: html; color: #fff; transparent: true; target: #"+this.name},this.init()}init(){const{data:t}=this.params,e=Object.keys(t)[0];switch(e){case"image":this.materials.board="shader: flat; color: #fff; src: ./../session/pdf_img/"+t[e],this.width=18,this.height=.5625*this.width,this.scale=new O.Vector3(this.width,this.height,1);break;default:t[e].key=e,this.containers.boardContentBody=this.createContent((t=>{const{slug:e,category_jp:s,category_en:i,theme_jp:o,theme_en:a,title_jp:r,title_en:n,leader_name_jp:h,leader_name_en:l,research_field_jp:c,research_field_en:d,group_members_jp:m,group_members_en:p,summary_jp:g,summary_en:u,summary_split:f}=t;let y=`\n\t<div class="detail_content_container summary entry_${e}">\n\t<div class="detail_content_container_inner">\n\t`;switch(t.key){case"meta":y=`${y}\n\t\t\t<header class="detail_header_container">\n\t\t\t<div class="slug">${e.toUpperCase()}</div>\n\t\t\t<p class="category_jp">${s}</p>\n\t\t\t<p class="category_en">${i}</p>\n\t\t\t</header>\n\n\t\t\t<div class="detail_theme_container">\n\t\t\t<p class="theme_jp">${o}</p>\n\t\t\t<p class="theme_en">${a}</p>\n\t\t\t</div>\n\t\t\t<div class="detail_title_container">\n\t\t\t<h1 class="title_jp">${r}</h1>\n\t\t\t<p class="title_en">${n}</p>\n\t\t\t</div>\n\t\t\t<div class="detail_author_container">\n\t\t\t<p class="leader_name_jp">${h}</p>\n\t\t\t<p class="leader_name_en">${l}</p>\n\t\t\t<p class="research_field_jp">${c}</p>\n\t\t\t<p class="research_field_en">${d}</p>\n\t\t\t<p class="group_members_jp">${m}</p>\n\t\t\t<p class="group_members_en">${p}</p>\n\t\t\t</div>\n\t\t\t`;break;case"summary":y=`${y}\n\t\t\t<div class="detail_summary_container ${f?"split":""}">\n\t\t\t<p class="summary_jp">${g||""}</p>\n\t\t\t<p class="summary_en">${(g==u?"":u)||""}</p>\n\t\t\t</div>\n\t\t\t`}return y+="</div></div>",y})(t[e]))}this.createBoard("board",this.containers.board,this.materials.board,!1)}}var Yt={...Nt,init(t){this.init_base(t),this.containers={...this.containers,detail:{}},this.addEvent()},fetchEntry:t=>new Promise((e,s)=>{pt.a.get("https://openhouse.nii.ac.jp/wp/wp-json/wp/v2/posts/?slug="+t).then(t=>{"data"in t&&t.data.length>0?e(t.data[0].acf):s("Data is empty.")}).catch(t=>{s(t)})}),async generateContent(t="a01"){this.containers.detail.board=this.generateContainer(E,this.scene),this.boardList.length=0,this.hudUIList.length=0;const e=[],s=document.getElementById(f),i=await this.fetchEntry(t).catch(t=>{console.error(t),r.dispatch(a.BackToPoster)});[i.pdf_name_01,i.pdf_name_02,i.pdf_name_03].filter(t=>""!=t).forEach(t=>{e.push({image:t+".png"})});const{category_jp:o,category_en:n,theme_jp:h,theme_en:l,title_jp:c,title_en:d,leader_name_jp:m,leader_name_en:p,research_field_jp:g,research_field_en:u,group_members_jp:y,group_members_en:b}=i;e.push({meta:{slug:t,category_jp:o,category_en:n,theme_jp:h,theme_en:l,title_jp:c,title_en:d,leader_name_jp:m,leader_name_en:p,research_field_jp:g,research_field_en:u,group_members_jp:y,group_members_en:b}});const{summary_jp:_,summary_en:w}=i,C=Array.from(_).length>250;C?(e.push({summary:{slug:t,summary_split:C,summary_jp:_}}),e.push({summary:{slug:t,summary_split:C,summary_en:w}})):e.push({summary:{slug:t,summary_split:C,summary_jp:_,summary_en:w}});const T=e.length;for(let t=0;t<T;t++){const i={index:t,name:"detail_"+t,boardId:D,containers:{board:this.containers.detail.board,boardContent:s},data:e[t]};this.boardList.push(new Qt(i))}this.showBoard(54,this.boardList,18),this.generateHUD(j.BackToPoster,[0,15,-20])},addEvent(){r.add(a.ShowDetail,t=>this.generateContent(t.slug)),r.add(a.BackToPoster,()=>this.destroy())}};var te=window.AFRAME.registerComponent(P,{props:{},modules:{},init(){console.log("Detail Component Init."),this.props.scene=this.el.object3D,this.props.container=this.el.appendChild(document.createElement("a-entity")),this.modules.detail=Yt,this.modules.detail.init(this.props.container)},tick(){null!=this.modules.detail&&this.modules.detail.draw()},onKeyUp(t){}});var ee=window.AFRAME.registerComponent(L,{props:{},init:function(){this.el.addEventListener("raycaster-intersection",t=>{const e=t.detail.intersections;e.length>0&&(e[0].object.el.instance.onRaycastForcedOn(this.el),e[0].object.material.color.set(R))}),this.el.addEventListener("raycaster-intersection-cleared",t=>{const e=t.detail.clearedEls;for(var s=0;s<e.length;s++){const t=e[s].object3DMap;"mesh"in t&&(t.mesh.el.instance.onRaycastForcedOff(this.el),t.mesh.material.color.set(z))}})}});var se=window.AFRAME.registerComponent(M,{init(){this.el.addEventListener("click",t=>{switch(this.el.object3DMap.mesh.material.color.set(16711680),this.el.instance.boardId){case I:r.dispatch(a.ShowDetail,{slug:this.el.instance.slug});break;case A:r.dispatch(a.ShowPoster,this.el.instance.category);break;case j.BackToCategory:r.dispatch(a.BackToCategory);break;case j.BackToPoster:r.dispatch(a.BackToPoster);break;case j.VRModeStart:r.dispatch(a.VRModeStart);break;case j.ShowCategoryA:r.dispatch(a.ShowCategoryA);break;case j.ShowCategoryD:r.dispatch(a.ShowCategoryD);break;case j.ShowCategoryG:r.dispatch(a.ShowCategoryG)}})}});var ie={...U,props:{elements:{}},components:{},init(){return console.log("XR App Init."),this.components.background=Kt,this.components.gallery=Zt,this.components.detail=te,this.components.raycastCheck=ee,this.components.raycastTarget=se,this},setup(){this.props.elements.scene=document.getElementById(b),this.attachComponent(this.props.elements.scene,k),this.attachComponent(this.props.elements.scene,S),this.attachComponent(this.props.elements.scene,P),this.props.elements.xr_player=this.attachComponent(document.getElementById(_),L),this.props.elements.xr_raycaster=document.getElementById(w),this.attachComponent(this.props.elements.xr_raycaster,"raycaster","objects: ."+C),this.attachComponent(this.props.elements.xr_raycaster,"cursor","fuse: false; fuse-timeout: 2000")},attachComponent:(t,e,s="")=>null!=t?t.setAttribute(e,s):null,onKeyUp(t){null!=this.components.background&&this.components.background.prototype.onKeyUp(t)}};var oe={...U,props:{instance:null},init(){return this.props.instance=ie.init(),this},setup(){this.props.instance.setup()},update(){},draw(){},destroy(){},onResize(){this.props.instance.onResize()},onMouseMove(t){this.props.instance.onMouseMove(t)},onKeyUp(t){this.props.instance.onKeyUp(t)}};s(25);var ae={props:{isPause:!1},instances:{},init(){return V()?this.instances.xr=oe.init():(this.instances.background=wt.init(),this.instances.gallery=Mt.init()),this.addEvent(),this.setup(),this},setup(t={}){this.instances.forIn((t,e)=>e.setup()),this.update()},update(){this.instances.forIn((t,e)=>e.update()),window.requestAnimationFrame(()=>{this.props.isPause||this.update()}),this.draw()},draw(){this.instances.forIn((t,e)=>e.draw())},destroy(){},pause(){this.props.isPause=!0},resume(){this.props.isPause=!1},onResize(){this.instances.forIn((t,e)=>e.onResize())},onMouseMove(t){this.instances.forIn((e,s)=>s.onMouseMove(t))},onKeyUp(t){this.instances.forIn((e,s)=>s.onKeyUp(t))},onClick(t){this.instances.forIn((e,s)=>s.onClick(t))},addEvent(t){}};const re={};re.PosterSession=re.PosterSession||{},re.PosterSession.App={delegator:null,init(){this.addExtensions(),this.delegator=ae.init(),this.addEvent()},onResize(){this.delegator.onResize()},onMouseMove(t){this.delegator.onMouseMove(t)},onKeyUp(t){this.delegator.onKeyUp(t)},onClick(t){this.delegator.onClick(t)},addEvent(){window.addEventListener("resize",()=>this.onResize()),window.addEventListener("mousemove",t=>this.onMouseMove(t)),window.addEventListener("keyup",t=>this.onKeyUp(t)),document.addEventListener("click",t=>this.onClick(t))},addExtensions(){i.init()}},window.addEventListener("DOMContentLoaded",()=>{((t=!0)=>{n.enable=t})(document.getElementsByTagName("a-scene").length>0),console.log("VRMode: "+V()),re.PosterSession.App.init()})}});