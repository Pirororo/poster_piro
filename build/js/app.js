!function(t){function e(e){for(var s,r,n=e[0],h=e[1],l=e[2],d=0,m=[];d<n.length;d++)r=n[d],Object.prototype.hasOwnProperty.call(o,r)&&o[r]&&m.push(o[r][0]),o[r]=0;for(s in h)Object.prototype.hasOwnProperty.call(h,s)&&(t[s]=h[s]);for(c&&c(e);m.length;)m.shift()();return a.push.apply(a,l||[]),i()}function i(){for(var t,e=0;e<a.length;e++){for(var i=a[e],s=!0,n=1;n<i.length;n++){var h=i[n];0!==o[h]&&(s=!1)}s&&(a.splice(e--,1),t=r(r.s=i[0]))}return t}var s={},o={0:0},a=[];function r(e){if(s[e])return s[e].exports;var i=s[e]={i:e,l:!1,exports:{}};return t[e].call(i.exports,i,i.exports,r),i.l=!0,i.exports}r.m=t,r.c=s,r.d=function(t,e,i){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(r.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)r.d(i,s,function(e){return t[e]}.bind(null,s));return i},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="";var n=window.webpackJsonp=window.webpackJsonp||[],h=n.push.bind(n);n.push=e,n=n.slice();for(var l=0;l<n.length;l++)e(n[l]);var c=h;a.push([49,1]),i()}({27:function(t,e,i){var s=i(28),o=i(29);"string"==typeof(o=o.__esModule?o.default:o)&&(o=[[t.i,o,""]]);var a={insert:"head",singleton:!1};s(o,a);t.exports=o.locals||{}},29:function(t,e,i){(e=i(30)(!1)).push([t.i,'html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td,article,aside,canvas,details,embed,figure,figcaption,footer,header,hgroup,menu,nav,output,ruby,section,summary,time,mark,audio,video{margin:0;padding:0;border:0;font-size:100%;font:inherit;vertical-align:baseline}article,aside,details,figcaption,figure,footer,header,hgroup,menu,nav,section{display:block}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:"";content:none}table{border-collapse:collapse;border-spacing:0}body{margin:0;padding:0;background-color:#000}div,section,nav,article{box-sizing:border-box}html,body{margin:0;padding:0;width:100%;height:100%}body{font-family:"Helvetica Neue",Arial,"Hiragino Kaku Gothic ProN","Hiragino Sans",Meiryo,sans-serif;background-color:#000;overflow:hidden}.common_container{position:fixed;top:0;left:0;z-index:1}.common_screen_shade{position:fixed;width:100%;height:100%;z-index:2;background-color:#000}#content_container{position:relative}#background_container{z-index:1}#WebGL-output{width:100%;height:100%}#detail_container{z-index:20;visibility:hidden}#blocker{position:absolute}html,body{margin:0;padding:0;width:100%;height:100%}body{font-family:"Helvetica Neue",Arial,"Hiragino Kaku Gothic ProN","Hiragino Sans",Meiryo,sans-serif;background-color:#000;overflow:hidden}.common_container{position:fixed;top:0;left:0;z-index:1;visibility:visible;display:block}.common_screen_shade{position:fixed;width:100%;height:100%;z-index:2;background-color:#000}#content_container{position:relative}#background_container{z-index:1}#WebGL-output{width:100%;height:100%}#category_container{z-index:10}#category_stage{position:relative}#gallery_container{z-index:11}#dialog{position:fixed;top:0;left:0;color:#fff}#dialog button{padding:1em;font-size:1em}#buttons{position:fixed;top:0;right:0;z-index:1;background:#fff}#detail_container{z-index:20;visibility:hidden}#blocker{position:absolute}#xr_mode #content_container{position:fixed}#xr_mode #xr_scene{z-index:200}#xr_mode #hud_container{z-index:250}#xr_mode .hud_ui{position:absolute;top:300px;width:520px;height:140px;display:flex;align-items:center;justify-content:center;color:#fff;font-size:40px;font-weight:bold;background-color:rgba(200,200,200,.8);box-sizing:border-box}#xr_mode .gallery_poster_title{position:absolute;top:0;width:14.5em;height:7em;font-size:36px;line-height:1.4;color:#fff;font-weight:bold;background-color:rgba(0,0,0,.8);padding:2em .5em 0;box-sizing:border-box;user-select:none}#xr_mode .category_content_container{position:absolute;width:520px;height:520px;padding:80px .5em 0;font-size:36px;line-height:1.4;text-align:center;color:#fff;font-weight:bold;background-color:rgba(200,200,200,.8);box-sizing:border-box;user-select:none}#xr_mode .category_a{background:rgba(150,41,204,.6)}#xr_mode .category_b{background:rgba(41,95,204,.6)}#xr_mode .category_c{background:rgba(36,179,83,.6)}#xr_mode .category_d{background:rgba(46,199,230,.6)}#xr_mode .category_e{background:rgba(41,204,190,.6)}#xr_mode .category_f{background:rgba(68,41,204,.6)}#xr_mode .category_s{background:rgba(204,41,149,.6)}#xr_mode .category_id{font-size:48px;line-height:1;margin-bottom:20px}#xr_mode .category_title.english{font-size:40px;line-height:1.24}#xr_mode .category_title.japanese{position:absolute;top:300px;width:92%;text-align:center;font-weight:normal;font-size:24px}#xr_mode .category_copy{position:absolute;top:348px;width:92%;text-align:center;font-size:32px}#xr_mode #detail_container{visibility:visible;font-size:2rem}#xr_mode .detail_content_container{position:fixed;top:0;width:512px;height:512px;padding:2rem;font-size:24px;line-height:1.4;text-align:left;color:#000;font-weight:normal;background-color:rgba(255,255,255,.9);box-sizing:border-box;user-select:none}#xr_mode .detail_content_container.summary{padding:2rem 2rem 2rem}#xr_mode .detail_content_container_inner{position:relative;width:100%;height:100%;overflow:hidden}#xr_mode .detail_header_container{position:relative;margin-bottom:2.5rem}#xr_mode .slug{position:relative;line-height:1;font-size:1.4em;padding:.1rem 0 0 0}#xr_mode .category_jp{position:absolute;left:4.5rem;top:0;font-size:.6em;font-weight:bold}#xr_mode .category_en{position:absolute;left:4.5rem;top:1.2rem;font-size:.5em}#xr_mode .detail_theme_container{position:relative;margin-bottom:1.5rem}#xr_mode .theme_jp{font-size:.6em;font-weight:bold}#xr_mode .theme_en{font-size:.4em;margin-bottom:1rem}#xr_mode .detail_title_container{position:relative;margin-bottom:1.5em}#xr_mode .title_jp{font-size:1em;font-weight:bold;margin-bottom:.5rem}#xr_mode .title_en{font-size:.5em;margin-bottom:.1rem}#xr_mode .detail_author_container{position:relative;text-align:right;font-size:.6em}#xr_mode .leader_name_jp,#xr_mode .research_field_jp,#xr_mode .group_members_jp{font-weight:bold}#xr_mode .leader_name_en,#xr_mode .research_field_en,#xr_mode .group_members_en{font-size:.8em;margin-bottom:.5rem}#xr_mode .detail_summary_container{position:relative;font-size:.7em;line-height:1.7}#xr_mode .summary_jp{font-size:1em;margin-bottom:1rem}#xr_mode .summary_en{font-size:.7em}#xr_mode .detail_summary_container.split .summary_jp{margin-bottom:0}#xr_mode .detail_summary_container.split .summary_en{line-height:1.6;font-size:.85em}',""]),t.exports=e},49:function(t,e,i){"use strict";i.r(e);i(27);var s={init(){Object.defineProperty(Object.prototype,"forIn",{value:function(t,e){e=e||this,Object.keys(this).forEach((function(i,s){const o=this[i];t.call(e,i,o,s)}),this)}}),Object.defineProperty(Object.prototype,"isEmpty",{value:function(t,e){return!Object.keys(this).length}})}};const o={instance:null,events:[]},a={ShowPoster:"ShowPoster",ShowDetail:"ShowDetail",BackToCategory:"BackToCategory",BackToPoster:"BackToPoster",VRModeStart:"VRModeStart",ShowCategoryA:"ShowCategoryA",ShowCategoryB:"ShowCategoryB",ShowCategoryC:"ShowCategoryC",ShowCategoryD:"ShowCategoryD",ShowCategoryE:"ShowCategoryE",ShowCategoryF:"ShowCategoryF",ShowCategoryG:"ShowCategoryG"},r={dispatch:(t,e)=>{if(!(t in a)||null==o.instance)return!1;o.instance.dispatchEvent(new CustomEvent(t,{detail:e}))},addListener:(t,e)=>{if(!(t in a))return!1;o.instance=null!=o.instance?o.instance:document.createElement("div"),o.instance.addEventListener(t,t=>{null!=e&&e(t.detail)}),o.events.push({event:e})},addEventListener(t,e){this.addListener(t,e)},add(t,e){this.addListener(t,e)}},n={enable:!1},h=32,l=a,c="background_container",d="hud_ui_stage",m="category_stage",p="gallery_container",g="gallery_stage",u="detail_container",f="detail_stage",y="detail_blocker",b="xr_scene",w="xr_player",_="xr_raycaster",C="xr_raycast_target",T="xr_hud_container",v="xr_category_board_container",x="xr_poster_panel_container",B="xr_poster_title_container",k="xr_detail_container",E="background-component",S="gallery-component",A="detail-component",M="raycast-check-component",P="raycast-target-component",L="category",I="poster",D="detail",R={BackToCategory:"ui_back_category",BackToPoster:"ui_back_poster",VRModeStart:"VRModeStart",ShowCategoryA:"ShowCategoryA",ShowCategoryB:"ShowCategoryB",ShowCategoryC:"ShowCategoryC",ShowCategoryD:"ShowCategoryD",ShowCategoryE:"ShowCategoryE",ShowCategoryF:"ShowCategoryF",ShowCategoryG:"ShowCategoryG"},j=10066329,z=16777215,G=(t=null)=>n.enable,V=(t,e=0,i={})=>{null!=t&&setTimeout(()=>t(i),e)},F={init(){return this},setup(){},update(){},draw(){},destroy(){},onResize(){},onMouseMove(t){},onKeyUp(t){},onClick(t){}};var U=i(0);const O=75,W=83,K=32,H=65,$=66,N=67,q=68,J=69,X=70,Z=71,Q=8;i(31);var Y=i(19),tt=i(20),et=i(5),it=i(21),st=i(7),ot=i(26),at=i(22),rt=i(3),nt=i(6),ht={uniforms:{tDiffuse:{value:null},color:{value:new nt.Color(16711680)},color2:{value:new nt.Color(16711680)},targetColor:{value:new nt.Color(16711680)},targetColor2:{value:new nt.Color(16711680)},time:{value:0},duration:{value:0}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform vec3 color;","uniform vec3 color2;","uniform vec3 targetColor;","uniform vec3 targetColor2;","uniform float time;","uniform float duration;","uniform sampler2D tDiffuse;","varying vec2 vUv;","void main() {","vec4 texel = texture2D( tDiffuse, vUv );","vec3 luma = vec3( 0.299, 0.587, 0.114 );","float v = dot( texel.xyz, luma );","float deltaTime = time/duration;","vec3 distColor = targetColor - color;","vec3 nowColor = distColor * deltaTime * deltaTime + color; ","vec3 distColor2 = targetColor2 - color2;","vec3 nowColor2 = distColor2 * deltaTime * deltaTime + color2; ","vec3 gradate = nowColor * vUv.y + nowColor2 * (1.0 - vUv.y);","gl_FragColor = vec4(v * gradate, texel.w );","}"].join("\n")};class lt{constructor(t){this.masterFrame=0,this._initStats=this._initStats.bind(this),this.chooseRoomColor=this.chooseRoomColor.bind(this),this.backToColor=this.backToColor.bind(this),this._stats=this._initStats(),this._scene=t,this._renderer=new U.WebGLRenderer({antialias:!0,alpha:!0}),this._renderer.setClearColor(new U.Color(0),0),this._renderer.setSize(window.innerWidth,window.innerHeight),this._renderer.setPixelRatio(1),this._wrapper=document.getElementById("WebGL-output"),this._wrapper.appendChild(this._renderer.domElement),this.clock=new U.Clock,this.onResize();var e=new tt.a(this._scene,this._scene.camera);e.clear=!0;new et.b(this._scene,this._scene.camera),new it.a;this.colorify=new st.a(ht),this.gradColor1=7556260,this.gradColor2=322168,this.targetGradColor1=7556260,this.targetGradColor2=322168,this.colorify.uniforms.color.value=new U.Color(this.gradColor1),this.colorify.uniforms.color2.value=new U.Color(this.gradColor2),this.colorify.uniforms.targetColor.value=new U.Color(this.targetGradColor1),this.colorify.uniforms.targetColor2.value=new U.Color(this.targetGradColor2),this.colorify.uniforms.time.value=0,this.duration=60,this.colorify.uniforms.duration.value=this.duration,this.colorify.uniforms.alpha=.8,this.colorify.enabled=!0,this.gradeColorBool=!1,this.gradeColorFrame=0,this.saveColor1=0,this.saveColor2=0;var i=new ot.a(2,15,3,64);i.enabled=!0;var s=new st.a(rt.a);s.renderToScreen=!0,this.composer=new at.a(this._renderer),this.composer.renderTarget1.stencilBuffer=!0,this.composer.renderTarget2.stencilBuffer=!0,this.composer.addPass(e),this.composer.addPass(this.colorify),this.composer.addPass(i),this.composer.addPass(s)}update(){this.masterFrame+=1,2==this.masterFrame&&(this._stats.update(),this._scene.update(),1==this.gradeColorBool&&(this.gradeColorFrame+=1,this.colorify.uniforms.time.value=this.gradeColorFrame,this.gradeColorFrame>this.duration&&(this.gradeColorBool=!1,this.gradeColorFrame=0)),this._renderer.autoClear=!1,this.composer.render(),this.masterFrame=0)}onKeyUp(t){t.keyCode==H&&this.chooseRoomColor(this._scene.camTargetBool_A,2711500,9841100),t.keyCode==$&&this.chooseRoomColor(this._scene.camTargetBool_B,3065829,2711500),t.keyCode==N&&this.chooseRoomColor(this._scene.camTargetBool_C,10939250,2404947),t.keyCode==q&&this.chooseRoomColor(this._scene.camTargetBool_D,2525571,41595),t.keyCode==J&&this.chooseRoomColor(this._scene.camTargetBool_E,14973,2525571),t.keyCode==X&&this.chooseRoomColor(this._scene.camTargetBool_F,9841100,2711500),t.keyCode==Z&&this.chooseRoomColor(this._scene.camTargetBool_G,13379989,9841100),t.keyCode==Q&&this.backToColor(this._scene.camTargetBool_BACKSPACE),this._scene.onKeyUp(t)}chooseRoomColor(t,e,i){1==t&&(this.gradeColorBool=!0,this.colorify.uniforms.color.value=new U.Color(this.gradColor1),this.colorify.uniforms.color2.value=new U.Color(this.gradColor2),this.colorify.uniforms.targetColor.value=new U.Color(e),this.colorify.uniforms.targetColor2.value=new U.Color(i)),this.saveColor1=e,this.saveColor2=i}backToColor(t){1==t&&(this.gradeColorBool=!0,this.colorify.uniforms.color.value=new U.Color(this.saveColor1),this.colorify.uniforms.color2.value=new U.Color(this.saveColor2),this.colorify.uniforms.targetColor.value=new U.Color(this.gradColor1),this.colorify.uniforms.targetColor2.value=new U.Color(this.gradColor2))}addEvent(){this._scene.addEvent()}draw(){}onResize(){const t=this._wrapper.clientWidth,e=this._wrapper.clientHeight;this._renderer.domElement.setAttribute("width",String(t)),this._renderer.domElement.setAttribute("height",String(e)),this._renderer.setPixelRatio(window.devicePixelRatio||1),this._renderer.setSize(t,e),this._scene.camera.aspect=t/e,this._scene.camera.updateProjectionMatrix()}_initStats(){return this._stats=new Y.a,this._stats.setMode(0),this._stats.domElement.style.position="absolute",this._stats.domElement.style.left="0px",this._stats.domElement.style.top="0px",document.getElementById("Stats-output").appendChild(this._stats.domElement),this._stats}}class ct extends U.PerspectiveCamera{constructor(){super(45,window.innerWidth/window.innerHeight,1,1e3),this.frame=0,this.eansingBool=!0,this.camPos=new U.Vector3(100,300,120),this.camTarget=new U.Vector3(-470,0,400),this.lookPos=new U.Vector3(45,50,45),this.lookTarget=new U.Vector3(45,50,45),this.getCamPos=this.getCamPos.bind(this)}update(){this.frame<1800?this.frame+=2:(this.frame=1800,this.eansingBool),1==this.eansingBool&&(this.camPos.x+=.012*(this.camTarget.x-this.camPos.x)*2,this.camPos.y+=.012*(this.camTarget.y-this.camPos.y)*2,this.camPos.z+=.012*(this.camTarget.z-this.camPos.z)*2,this.position.set(this.camPos.x,this.camPos.y,this.camPos.z),this.lookPos.x+=.02*(this.lookTarget.x-this.lookPos.x)*2,this.lookPos.y+=.02*(this.lookTarget.y-this.lookPos.y)*2,this.lookPos.z+=.02*(this.lookTarget.z-this.lookPos.z)*2,this.lookAt(this.lookPos)),this.frame>=0&&this.frame<1170&&(this.frame,50==this.frame&&(this.lookTarget=new U.Vector3(45,80,45)),100==this.frame&&(this.camTarget=new U.Vector3(70,-180,-150)),280==this.frame&&(this.lookTarget=new U.Vector3(45,50,45),this.camTarget=new U.Vector3(-120,350,320)),460==this.frame&&(this.frame+=320),420==this.frame&&(this.camTarget=new U.Vector3(170,150,50)),700==this.frame&&(this.camTarget=new U.Vector3(230,60,-60)),900==this.frame&&(this.camTarget=new U.Vector3(100,-100,-130))),1150==this.frame&&(this.frame+=50),this.frame>=1200&&(1200==this.frame&&(this.lookTarget=new U.Vector3(140,70,140),this.camTarget=new U.Vector3(240,480,160)),this.frame,1370==this.frame&&(this.lookTarget=new U.Vector3(70,40,70),this.camTarget=new U.Vector3(10,3,-20)))}getCamPos(){}}var dt=i(9),mt=i(8),pt=i.n(mt);const gt=(t,e)=>{if(null==t||null==e)return;const i=new XMLHttpRequest,s=t=>{e({result:t.target.response}),i.removeEventListener("load",s)};i.addEventListener("load",s),i.open("GET",t,!0),i.send()};class ut extends U.Object3D{constructor(t,e){super(),this.frame=0,this.Times=0,this.prepareMesh=this.prepareMesh.bind(this),this.checkIntersection=this.checkIntersection.bind(this),this.getlineLength=this.getlineLength.bind(this),this.loadCSVandConvertToArray2D=this.loadCSVandConvertToArray2D.bind(this),this.doSomething=this.doSomething.bind(this),this.meshes={},this.meshes[0]||(this.meshes[0]=this.prepareMesh()),this.lineLength=0,this.where=t,this.inout=e,this.data=[],this.loadCSVandConvertToArray2D(),this.DATAisOK=!1}prepareMesh(){for(var t=new Float32Array(300),e=0;e<t.length;e+=3)t[e]=t[e+1]=t[e+2]=0;var i=new dt.MeshLine;i.setGeometry(t,(function(t){return t}));let s=new dt.MeshLineMaterial({color:11250603,lineWidth:.6,depthTest:!1});return this.mesh=new U.Mesh(i.geometry,s),this.mesh.geo=t,this.mesh.g=i,this.add(this.mesh),this.mesh}checkIntersection(){this.mesh=this.meshes[0];for(var t=this.mesh.geo,e=this.mesh.g,i=0;i<t.length;i+=3)t[i]=1*t[i+3],t[i+1]=1*t[i+4],t[i+2]=1*t[i+5];let s=Math.random();this.getlineLength();let o=Math.random();this.lineLength*=o<.5?-1:1,s>.66?(t[t.length-6]>90&&this.lineLength>0&&(this.lineLength*=-1),t[t.length-6]<-45&&this.lineLength<0&&(this.lineLength*=-1),t[t.length-3]=t[t.length-6]+this.lineLength,t[t.length-2]=t[t.length-5],t[t.length-1]=t[t.length-4]):s>.33?(t[t.length-5]>90&&this.lineLength>0&&(this.lineLength*=-1),t[t.length-5]<-45&&this.lineLength<0&&(this.lineLength*=-1),t[t.length-3]=t[t.length-6],t[t.length-2]=t[t.length-5]+this.lineLength,t[t.length-1]=t[t.length-4]):(t[t.length-4]>90&&this.lineLength>0&&(this.lineLength*=-1),t[t.length-4]<-45&&this.lineLength<0&&(this.lineLength*=-1),t[t.length-3]=t[t.length-6],t[t.length-2]=t[t.length-5],t[t.length-1]=t[t.length-4]+this.lineLength),e.setGeometry(t)}getlineLength(){return this.lineLength=1*this.data[this.Times][2*this.where+this.inout],this.Times+=1,this.lineLength}loadCSVandConvertToArray2D(){gt("https://pirororo.github.io/poster_piro/build/data/kanto_all.csv",t=>{let e=((t,e=3)=>{if(null==t)return[];let i=[];const s=t.split("\n");for(let t=0;t<s.length;t++)i[t]=s[t].split(",");return i})(t.result);this.doSomething(e)})}doSomething(t){this.DATAisOK=!0,this.data=t,console.log(this.data[0][0])}update(){if(1==this.DATAisOK)if(this.frame<1800){if(this.frame+=1,this.frame%2==0)for(var t in this.meshes)this.checkIntersection(t)}else this.frame=1802}}class ft extends U.Scene{constructor(){super(),this.resetCamTargetBool=this.resetCamTargetBool.bind(this),this.openCamTargetBool=this.openCamTargetBool.bind(this),this.chooseRoom=this.chooseRoom.bind(this),this.camera=new ct,this.baseCamTarget=new U.Vector3(-200,70,400),this.scene0=new yt,this.add(this.scene0),this.frameBool_skipAnime=!0,this.camTargetBool_openingIsEnd=!1,this.resetCamTargetBool(),this.camTargetBool_BACKSPACE=!1}update(){1==this.scene0.scene2.openingIsEnd&&(console.log("Opening is end and select VR or not"),this.scene0.scene2.openingIsEnd=!1,this.camTargetBool_openingIsEnd=!0),this.camera.update(),this.scene0.update()}onKeyUp(t){t.keyCode==O&&1==this.frameBool_skipAnime&&this.scene0.scene2.frame<this.scene0.scene2.frameSlide-2&&(this.frameBool_skipAnime=!1,this.camera.frame=this.scene0.scene2.frameSlide-2,this.scene0.scene2.frame=this.scene0.scene2.frameSlide-2,console.log("skip animation !")),t.keyCode==K&&1==this.camTargetBool_openingIsEnd&&(this.camTargetBool_openingIsEnd=!1,this.camera.camTarget=this.baseCamTarget,this.camera.lookTarget=new U.Vector3(140,70,140),console.log("continue PC mode!"),this.openCamTargetBool()),t.keyCode==H&&this.chooseRoom(this.camTargetBool_A,0,"Go to room_A!"),t.keyCode==$&&this.chooseRoom(this.camTargetBool_B,1,"Go to room_B!"),t.keyCode==N&&this.chooseRoom(this.camTargetBool_C,3,"Go to room_C!"),t.keyCode==q&&this.chooseRoom(this.camTargetBool_D,4,"Go to room_D!"),t.keyCode==J&&this.chooseRoom(this.camTargetBool_E,6,"Go to room_E!"),t.keyCode==X&&this.chooseRoom(this.camTargetBool_F,7,"Go to room_F!"),t.keyCode==Z&&this.chooseRoom(this.camTargetBool_G,9,"Go to room_G!"),t.keyCode==Q&&1==this.camTargetBool_BACKSPACE&&(this.camTargetBool_BACKSPACE=!1,this.camera.camTarget=this.baseCamTarget,this.camera.lookTarget=new U.Vector3(140,70,140),console.log("Back to 7 panels!"),this.openCamTargetBool())}chooseRoom(t,e,i){1==t&&(t=!1,this.camera.lookTarget=new U.Vector3(25*(1.5+e),8+15*e,25*(1.5+e)),this.baseCamTarget=new U.Vector3(-200,70,400),this.camera.camTarget.subVectors(this.camera.lookTarget,this.baseCamTarget),this.camera.camTarget.multiplyScalar(.9),this.camera.camTarget.add(this.baseCamTarget),console.log(i),this.resetCamTargetBool())}resetCamTargetBool(){this.camTargetBool_BACKSPACE=!0,this.camTargetBool_A=!1,this.camTargetBool_B=!1,this.camTargetBool_C=!1,this.camTargetBool_D=!1,this.camTargetBool_E=!1,this.camTargetBool_F=!1,this.camTargetBool_G=!1}openCamTargetBool(){this.camTargetBool_BACKSPACE=!1,this.camTargetBool_A=!0,this.camTargetBool_B=!0,this.camTargetBool_C=!0,this.camTargetBool_D=!0,this.camTargetBool_E=!0,this.camTargetBool_F=!0,this.camTargetBool_G=!0}}class yt extends U.Scene{constructor(){super(),this.scene1=new bt,this.add(this.scene1),this.scene2=new wt,this.add(this.scene2)}update(){this.scene1.update(),this.scene2.update()}}class bt extends U.Scene{constructor(){super(),this._line=[this._line1in,this._line1out];for(let t=0;t<this._line.length/2;t++)for(let e=0;e<2;e++)this._line[2*t+e]=new ut(t,e+1),e%2==0?this._line[2*t+e].position.set(0,0,0):this._line[2*t+e].position.set(200,90,200),this.add(this._line[2*t+e])}setup(){}update(){for(let t=0;t<this._line.length;t++)this._line[t].update()}}class wt extends U.Scene{constructor(){super(),this.frame=0,this.frameSlide=1260,this.meshList=[],this.meshGroup=new U.Group;const t=new U.MeshBasicMaterial({color:16777215,wireframe:!0,opacity:.95,transparent:!0});this.PlateNum=320,this.positions=[],this.posTarget=[];for(let e=0;e<this.PlateNum;e++)this.floorsize=27,this.geometry=new U.PlaneBufferGeometry(this.floorsize,this.floorsize),this.mesh=new U.Mesh(this.geometry,t),this.mesh.position.set(0,0,0),this.mesh.rotation.x=90*Math.PI/180,this.meshGroup.add(this.mesh),this.meshList.push(this.mesh),this.positions.push(this.mesh.position.x,this.mesh.position.y,this.mesh.position.z),this.posTarget.push(0,0,0);this.add(this.meshGroup),this.clock=new U.Clock,this.tSpeed=2,this.easeElapsedTime=0,this.eansingBool=!0,this.openingIsEnd=!1}update(){if(this.frame<1800?this.frame+=2:(this.frame=1800,this.eansingBool),1==this.eansingBool){this.easeElapsedTime+=this.clock.getDelta(),this.t=this.easeElapsedTime/this.tSpeed,this.t>1&&(this.t=1),this.rate=this.t*this.t*(3-2*this.t);for(let t=0;t<this.meshList.length;t++){this.meshList[t].position.x=this.positions[3*t+0],this.meshList[t].position.y=this.positions[3*t+1],this.meshList[t].position.z=this.positions[3*t+2];for(let e=0;e<3;e++){let i=this.positions[3*t+e],s=this.posTarget[3*t+e];this.positions[3*t+e]=i*(1-this.rate)+s*this.rate}}}if(50==this.frame){for(let t=0;t<this.meshList.length;t++)for(let e=0;e<4;e++)t>=80*e&&t<80*(e+1)&&(this.posTarget[3*t+0]=25*e,this.posTarget[3*t+1]=0,this.posTarget[3*t+2]=0);this.easeElapsedTime=0,this.tSpeed=3}if(100==this.frame){for(let t=0;t<this.meshList.length;t++)for(let e=0;e<4;e++)if(t>=80*e&&t<80*(e+1))for(let i=0;i<4;i++)t>=80*e+20*i&&t<80*e+20*(i+1)&&(this.posTarget[3*t+0]=25*e,this.posTarget[3*t+1]=0,this.posTarget[3*t+2]=25*i);this.easeElapsedTime=0}if(150==this.frame){for(let t=0;t<this.meshList.length;t++)for(let e=0;e<4;e++)if(t>=80*e&&t<80*(e+1))for(let i=0;i<4;i++)if(t>=80*e+20*i&&t<80*e+20*(i+1))for(let s=0;s<20;s++)t>=80*e+20*i+1*s&&t<80*e+20*i+1*(s+1)&&(this.posTarget[3*t+0]=20*e,this.posTarget[3*t+1]=7*s,this.posTarget[3*t+2]=20*i);this.easeElapsedTime=0,this.tSpeed=3}if(230==this.frame){for(let t=0;t<this.meshList.length;t++)for(let e=0;e<4;e++)if(t>=80*e&&t<80*(e+1))for(let i=0;i<4;i++)if(t>=80*e+20*i&&t<80*e+20*(i+1))for(let s=0;s<10;s++)t>=80*e+20*i+2*s&&t<80*e+20*i+2*(s+1)&&(this.posTarget[3*t+0]=45*i,this.posTarget[3*t+1]=10*s,this.posTarget[3*t+2]=45*e);this.easeElapsedTime=0,this.tSpeed=3}if(310==this.frame){for(let t=0;t<this.meshList.length;t++)for(let e=0;e<4;e++)if(t>=80*e&&t<80*(e+1))for(let i=0;i<4;i++)if(t>=80*e+20*i&&t<80*e+20*(i+1))for(let s=0;s<10;s++)t>=80*e+20*i+2*s&&t<80*e+20*i+2*(s+1)&&(this.posTarget[3*t+0]=45*e,this.posTarget[3*t+1]=0,this.posTarget[3*t+2]=45*i);this.easeElapsedTime=0,this.tSpeed=3}if(360==this.frame){for(let t=0;t<this.meshList.length;t++)for(let e=0;e<4;e++)if(t>=80*e&&t<80*(e+1))for(let i=0;i<4;i++)if(t>=80*e+20*i&&t<80*e+20*(i+1))for(let s=0;s<10;s++)t>=80*e+20*i+2*s&&t<80*e+20*i+2*(s+1)&&(this.posTarget[3*t+0]=30*e,this.posTarget[3*t+1]=0,this.posTarget[3*t+2]=30*i);this.easeElapsedTime=0,this.tSpeed=3}if(410==this.frame){for(let t=0;t<this.meshList.length;t++)for(let e=0;e<8;e++)if(t>=40*e&&t<40*(e+1))for(let i=0;i<8;i++)if(t>=40*e+5*i&&t<40*e+5*(i+1))for(let s=0;s<5;s++)t>=40*e+5*i+1*s&&t<40*e+5*i+1*(s+1)&&(this.posTarget[3*t+0]=15*e,this.posTarget[3*t+1]=0,this.posTarget[3*t+2]=15*i);this.easeElapsedTime=0,this.tSpeed=3}if(460==this.frame&&(this.frame+=320),780==this.frame){for(let t=0;t<this.meshList.length;t++)for(let e=0;e<8;e++)if(t>=40*e&&t<40*(e+1))for(let i=0;i<8;i++)if(t>=40*e+5*i&&t<40*e+5*(i+1))for(let s=0;s<5;s++)t>=40*e+5*i+1*s&&t<40*e+5*i+1*(s+1)&&(this.posTarget[3*t+0]=70*Math.sin(2*t*Math.PI/180)+50,this.posTarget[3*t+1]=25,this.posTarget[3*t+2]=70*Math.cos(2*t*Math.PI/180)+50);this.easeElapsedTime=0,this.tSpeed=5}if(880==this.frame){for(let t=0;t<this.meshList.length;t++)for(let e=0;e<4;e++)if(t>=80*e&&t<80*(e+1))for(let i=0;i<4;i++)if(t>=80*e+20*i&&t<80*e+20*(i+1))for(let s=0;s<10;s++)t>=80*e+20*i+2*s&&t<80*e+20*i+2*(s+1)&&(this.posTarget[3*t+0]=20*i+50,this.posTarget[3*t+1]=1.5*s+25,this.posTarget[3*t+2]=4*e+50);this.easeElapsedTime=0,this.tSpeed=4}if(960==this.frame){for(let t=0;t<this.meshList.length;t++)for(let e=0;e<4;e++)if(t>=80*e&&t<80*(e+1))for(let i=0;i<4;i++)if(t>=80*e+20*i&&t<80*e+20*(i+1))for(let s=0;s<10;s++)t>=80*e+20*i+2*s&&t<80*e+20*i+2*(s+1)&&(this.posTarget[3*t+0]=70*Math.sin(4*t*Math.PI/180)+50,this.posTarget[3*t+1]=70*Math.cos(40*(e+i+s)*Math.PI/180)+25,this.posTarget[3*t+2]=-70*Math.sin(8*t*Math.PI/180)+50);this.easeElapsedTime=0,this.tSpeed=7}if(1080==this.frame){for(let t=0;t<this.meshList.length;t++)for(let e=0;e<4;e++)if(t>=80*e&&t<80*(e+1))for(let i=0;i<4;i++)if(t>=80*e+20*i&&t<80*e+20*(i+1))for(let s=0;s<10;s++)t>=80*e+20*i+2*s&&t<80*e+20*i+2*(s+1)&&(this.posTarget[3*t+0]=25*e,this.posTarget[3*t+1]=0,this.posTarget[3*t+2]=25*i);this.easeElapsedTime=0,this.tSpeed=4}if(1150==this.frame&&(this.frame+=50),1200==this.frame){for(let t=0;t<this.meshList.length;t++)for(let e=0;e<4;e++)if(t>=80*e&&t<80*(e+1))for(let i=0;i<4;i++)if(t>=80*e+20*i&&t<80*e+20*(i+1))for(let s=0;s<20;s++)t>=80*e+20*i+1*s&&t<80*e+20*i+1*(s+1)&&(this.posTarget[3*t+0]=20*e,this.posTarget[3*t+1]=5*s,this.posTarget[3*t+2]=20*i);this.easeElapsedTime=0,this.tSpeed=6}if(this.frame==this.frameSlide){for(let t=0;t<this.meshList.length;t++)for(let e=0;e<4;e++)if(t>=80*e&&t<80*(e+1))for(let i=0;i<4;i++)if(t>=80*e+20*i&&t<80*e+20*(i+1))for(let s=0;s<10;s++)t>=80*e+20*i+2*s&&t<80*e+20*i+2*(s+1)&&(this.posTarget[3*t+0]=25*(e+s),this.posTarget[3*t+1]=15*s,this.posTarget[3*t+2]=25*(i+s));this.easeElapsedTime=0,this.tSpeed=6}1420==this.frame&&0==this.openingIsEnd&&(this.openingIsEnd=!0)}}var _t={...F,props:{instance:null},init(){return this.props.instance=new lt(new ft),this},setup(){},update(){this.props.instance.update()},draw(){this.props.instance.draw()},destroy(){},onKeyUp(t){this.props.instance.onKeyUp(t)}},Ct=i(23),Tt=i(4);const vt={a:{categoryId:"A",categoryEn:"Architecture, Software",categoryJp:"アーキテクチャ・ソフトウェア",copy:"うごかすちから",imgPath:["./img/A01-sinetstream.png","./img/A02.png","./img/A03.png","./img/A04.png","./img/A05.png","./img/A06.png","./img/A07.png","./img/A08.png","./img/A10.png"],posterTitle:["ネットワークとクラウドを<br>活用してデータ収集から<br>解析まで","双方向化技術による<br>データベーススキーマの共存","サイエンスによる知的<br>ものづくり教育プログラム","プログラミング講義向け<br>Jupyter Notebook環境","Notebookで賢く運用！<br>NIIの研究クラウド","再構成可能デバイスを<br>使いやすくする研究","漸進的型付け: <br>安全性と柔軟性を<br>両立するプログラミング言語","不具合局所化のための<br>プログラムスペクトルの<br>可視化ならびに分析","経路計画機能の<br>テスト・設定調整の<br>自動探索","適切な「ぼかし」で、<br>ソフトウェアの<br>複雑さに挑む"]},b:{categoryId:"B",categoryEn:"Computation, Logic, <br> Quantum information",categoryJp:"数理・論理・量子情報",copy:"考え方をかんがえる",imgPath:["./img/B01.png","./img/B02.png","./img/B03.png","./img/B04.png","./img/B05.png","./img/B06.png","./img/B07.png","./img/B08.png"],posterTitle:["理論計算機科学入門： <br>有限と無限のあいだ <br>~ オートマトン理論を例に","量子の世界に潜むスケール<br>フリーネットワーク","計算量理論と暗号の安全性","Inner-iteration preconditioned <br>block GMRES","ネットワークにおける頂点の<br>重要度の感度解析","口コミ効果の最大化:<br>やってみよう!<br>ゲーム Infomania","食品価格の時系列表現の<br>形式化","数学からソフトウェア、<br>そしてものづくりへ"]},c:{categoryId:"C",categoryEn:"Artificial intelligence",categoryJp:"人工知能",copy:"計算機に思考させる",imgPath:["./img/C01.png","./img/C02.png","./img/C03.png","./img/C04.png","./img/C05.png","./img/C06.png","./img/C07.png","./img/C08.png","./img/C09.png","./img/C10.png"],posterTitle:["医療ビッグデータクラウド<br>基盤構築とAI画像解析研究","知識表現・推論と機械学習を統合<br>したロバストAI","コンピュータが法律推論？","機械読解における<br>質問回答ペアの生成モデル","機械学習で知識発見","機械学習の幾何学的解釈","ロバストインテリジェンスを<br>社会的な課題解決に役立てる<br>ための応用技術に関する研究","クラウド型VRによる対話型<br>知能ロボットのオンライン競技会","視聴覚クロスモーダル検索のための<br>共同埋め込みの学習","自然言語処理の実社会応用"]},d:{categoryId:"D",categoryEn:"Visual, audio, media",categoryJp:"映像・音・メディア",copy:"みる・きく・はなす・さがす",imgPath:["./img/D01.png","./img/D02.png","./img/D03.png","./img/D04.png","./img/D05.png","./img/D06.png","./img/D07.png","./img/D08.png"],posterTitle:["情報学データ資源の共同利用","NTCIR Challenges","セマンティック画像生成","実空間と整合する３次元映像<br>メディアに向けた光線情報符号化","ROIS-DS人文学オーブンデータ<br>共同利用センター","デッサン時の視線解析に<br>基づく物体の質感構成要素<br>の抽出","記憶に残る鑑賞体験のための<br>ガイドアプリ：みんぱく<br>ガイド@国立民族学博物館","テレビアーカイブを用いた<br>視聴者の行動センシング"]},e:{categoryId:"E",categoryEn:"Network, security",categoryJp:"ネットワーク・セキュリティ",copy:"安心につながる",imgPath:["./img/E01.png","./img/E02.png","./img/E03.png","./img/E04.png","./img/E05.png","./img/E06.png"],posterTitle:["ネットワーク事前知識を<br>活用したSINETログ<br>データの因果解析","サブ6GHz及びミリ波帯を<br>共用するBeyond 5G<br>ネットワークの為の<br>深層強化学習を活用した<br>アクセスポイント選択法","時空間深層学習モデルによる<br>ネットワークトラフィックの補間推定","マルチメディアセキュリティ・<br>プライバシー","Deepfake Detection and <br>Segmentation","Gait Anonymization Using <br>Deep Learning"]},f:{categoryId:"F",categoryEn:"Society and information",categoryJp:"社会と情報",copy:"サイバー世界と<br>フィジカル世界の融合",imgPath:["./img/F01.png","./img/F02.png","./img/F03.png","./img/F04.png","./img/F05.png","./img/F06.png","./img/F07.png","./img/F08.png","./img/F09.png"],posterTitle:["ブロックチェーンの登場で<br>社会はどう変化するのか？","","ソフトウェア工学からみた<br>機械学習","新型コロナウイルス感染症<br>対策への位置情報ビッグ<br>データの応用","ネットワーク投票力指数：<br>株式保有ネットワークに<br>おける間接的支配の測定","過積載を見逃さない道路橋","料理レシピ：カーボンフット<br>プリントを改善するには？","Flavorlens 2.0","Early stress detection and <br>absenteeism reduction"]},s:{categoryId:"特別展示",categoryEn:"Special Exhibition",categoryJp:"サービス・事業含む",copy:"",imgPath:["./img/S01.png","./img/S02.png","./img/S03.png","./img/S04.png"],posterTitle:["湘南会議","国立情報学研究所の<br>広報活動を紹介","情報学専攻の概要紹介と<br>入試案内","学術情報基盤の整備"]}};class xt{constructor(t,e){this.posterData=vt,this.currentCategory=null,this.categoryId=t,this.id=e,this.imgTexture=null,this.canvasTexture=null,this.boardWidth=80,this.boardHeight=45,this.fontSize=6,this.categories=vt.categories}setup(){switch(this.categoryId){case"a":this.currentCategory=this.posterData.a;break;case"b":this.currentCategory=this.posterData.b;break;case"c":this.currentCategory=this.posterData.c;break;case"d":this.currentCategory=this.posterData.d;break;case"e":this.currentCategory=this.posterData.e;break;case"f":this.currentCategory=this.posterData.f;break;default:this.currentCategory=this.posterData.s}}loadTexture(){const t=new U.TextureLoader;return this.imgTexture=t.load(this.currentCategory.imgPath[this.id]),this.imgTexture}createLabel(){const t=this.currentCategory.posterTitle[this.id],e=document.createElement("canvas");e.width=8*this.boardWidth,e.height=8*this.boardHeight;const i=e.getContext("2d");i.scale(8,8),i.font=this.fontSize+"px Arial, meiryo, sans-serif",i.fillStyle="rgba(255,255,255,1)";const s=t.split("<br>"),o=1.4*i.measureText("あ").width;return s.forEach((function(t,e){i.fillText(t,0,10+o*e)})),this.canvasTexture=new U.Texture(e),this.canvasTexture.needsUpdate=!0,this.canvasTexture}createCategory(t){const e=[];return this.posterData.forIn((t,i,s)=>{e[s]={},e[s].cateroryId=i.categoryId,e[s].categoryEn=i.categoryEn,e[s].categoryJp=i.categoryJp,e[s].copy=i.copy}),e}}class Bt extends class{constructor(t,e){this.texture=e||{},this.scene=t,this.boardWidth=80,this.boardHeight=45,this.imageGeometry,this.imageMaterial,this.imageShape=null,this.imagePosition=new U.Vector3,this.labelGeometry,this.labelMaterial,this.labelShape=null,this.labelPosition=new U.Vector3,this.wireGeometry,this.wireMaterial,this.wireShape=null,this.group=new U.Object3D,this.position=new U.Vector3}setup(){return this.scene.add(this.group),this}update(){null!=this.group&&this.draw()}draw(){}destroy(){this.scene.remove(this.group)}getScene(){return this.scene}}{constructor(t,e){super(t,e),this.imageGeometry=new U.PlaneGeometry(this.boardWidth,this.boardHeight),this.imageMaterial=new U.MeshBasicMaterial({color:16777215,map:this.texture.image,transparent:!0,opacity:0}),this.imageShape=new U.Mesh(this.imageGeometry,this.imageMaterial),this.group.add(this.imageShape),this.labelGeometry=new U.PlaneGeometry(this.boardWidth,this.boardHeight),this.labelMaterial=new U.MeshBasicMaterial({map:this.texture.label,transparent:!0,opacity:0}),this.labelShape=new U.Mesh(this.labelGeometry,this.labelMaterial),this.labelShape.position.y=-45,this.group.add(this.labelShape),this.wireGeometry=new U.WireframeGeometry(this.imageGeometry),this.wireMaterial=new U.LineBasicMaterial({color:16777215,transparent:!0,opacity:0}),this.wireShape=new U.LineSegments(this.wireGeometry,this.wireMaterial),this.group.add(this.wireShape)}}class kt{constructor(t,e,i=1){this.id=i,this.scene=t.getScene(),this.view=t,this.model=e,this.addEvent()}update(){this.view.update()}shapeChange(){}addEvent(){}}class Et{constructor(t,e,i=1){this.id=i,this.scene=t,this.model=new xt(e,this.id),this.model.setup();const s={image:this.model.loadTexture(),label:this.model.createLabel()};this.view=new Bt(this.scene,s).setup(),this.controller=new kt(this.view,this.model,this.id)}}class St{constructor(t,e){this.stage=t,this.categoryData=e}setup(){this.categoryWrapper=this.createDomElement("div","category-wrapper"),this.stage.appendChild(this.categoryWrapper);const t=document.createElement("ul");this.categoryWrapper.appendChild(t);const e=[];for(let i=0;i<this.categoryData.length;i++){e[i]=document.createElement("li"),t.appendChild(e[i]);const s=this.createDomElement("div","category-container cat"+i);e[i].appendChild(s);const o=this.createDomElement("div","caterory-label",this.categoryData[i].categoryId);s.appendChild(o);const a=this.createDomElement("div","categoryEn",this.categoryData[i].categoryEn);s.appendChild(a);const r=this.createDomElement("div","categoryJp",this.categoryData[i].categoryJp);s.appendChild(r);const n=this.createDomElement("div","categoryCopy",this.categoryData[i].copy);s.appendChild(n)}setTimeout(()=>{this.categoryWrapper.classList.add("fadein")},1e3)}update(){this.draw()}draw(){}destroy(){this.categoryWrapper.classList.remove("fadein"),setTimeout(()=>{this.stage.removeChild(this.categoryWrapper)},1e3)}getScene(){return this.stage}createDomElement(t,e,i){const s=document.createElement(t);if(i){s.setAttribute("class",e);const t=document.createTextNode(i);s.appendChild(t)}else s.setAttribute("class",e);return s}}class At{constructor(t){this.stage=t,this.categoryId=null,this.id=null,this.model=new xt(this.categoryId,this.id),this.model.setup();const e=this.model.createCategory();this.view=new St(this.stage,e),this.view.setup()}}class Mt{constructor(){}init(){this.setup(),this.createScene(),this.createCamera(),this.addOrbitControls(),this.addAmbientLight(),this.addDirectionalLight(),this.addCategory()}setup(){this.backgroundColor="#000000",this.width=window.innerWidth,this.height=window.innerHeight,this.mouse3D=new U.Vector2,this.meshList=[],this.raycaster=new U.Raycaster,this.rayReceiveObjects=[],this.posterData=vt.a,this.boardLength=this.posterData.imgPath.length,this.boardPosRadius=150;this.boardAngle=180/this.boardLength,this.halfAngle=180+this.boardAngle}draw(){this.raycaster.setFromCamera(this.mouse3D,this.camera);const t=this.raycaster.intersectObjects(this.rayReceiveObjects);this.rayReceiveObjects.map(e=>{t.length>0&&e===t[0].object?e.material.color.setHex(16777215):e.material.color.setHex(2236962)}),this.controls.update(),Tt.a.update(),this.renderer.render(this.scene,this.camera)}onMouseMove({clientX:t,clientY:e}){this.mouse3D.x=t/this.width*2-1,this.mouse3D.y=-e/this.height*2+1}onResize(){this.width=window.innerWidth,this.height=window.innerHeight,this.camera.aspect=this.width/this.height,this.camera.updateProjectionMatrix(),this.renderer.setSize(this.width,this.height)}onClick(t){const e=this.raycaster.intersectObjects(this.rayReceiveObjects);if(e.length>0){const t=e[0].object.name;console.dir(t),document.dispatchEvent(new CustomEvent(l.ShowDetail,{detail:{message:"Please show me a detail!"}}))}}addCategory(){const t=document.getElementById("category_stage");this.category=new At(t)}addBorad(){const t=new U.Vector3(0,30,0),e=new U.Vector3(0,-50,0);for(let i=0;i<this.boardLength;i++){let s;this.board=new Et(this.scene,"a",i),i%2==0?(this.board.view.group.position.y=40,s=t):(this.board.view.group.position.y=-50,s=e),this.board.view.group.position.set(this.boardPosRadius*Math.cos(U.Math.degToRad(i*this.boardAngle+this.halfAngle)),this.board.view.group.position.y,this.boardPosRadius*Math.sin(U.Math.degToRad(i*this.boardAngle+this.halfAngle))),this.board.view.group.lookAt(s),this.meshList.push(this.board),this.meshList[i].view.imageShape.name="poster"+i,this.rayReceiveObjects.push(this.meshList[i].view.imageShape)}this.setBoardAnime()}setBoardAnime(){for(let t=0;t<this.boardLength;t++){const e={x:this.meshList[t].view.group.position.x,y:this.meshList[t].view.group.position.y-100,z:this.meshList[t].view.group.position.z,alpha:this.meshList[t].view.imageMaterial.opacity},i={x:e.x,y:this.meshList[t].view.group.position.y,z:e.z,alpha:1},s=new Tt.a.Tween(e).to(i,500).easing(Tt.a.Easing.Cubic.InOut).onUpdate(()=>{this.meshList[t].view.group.position.x=e.x,this.meshList[t].view.group.position.y=e.y,this.meshList[t].view.group.position.z=e.z,this.meshList[t].view.labelMaterial.opacity=o.alpha,this.meshList[t].view.imageMaterial.opacity=o.alpha,this.meshList[t].view.wireMaterial.opacity=e.alpha}).delay(1e3+50*t).start(),o={alphaA:0,alphaB:1},a={alphaA:1,alphaB:0},r=new Tt.a.Tween(o).to(a,300).easing(Tt.a.Easing.Cubic.InOut).onUpdate(()=>{this.meshList[t].view.imageMaterial.opacity=o.alphaA,this.meshList[t].view.labelMaterial.opacity=o.alphaA}).delay(1e3+10*t);s.chain(r);new Tt.a.Tween(o).to(a,300).easing(Tt.a.Easing.Cubic.InOut).onUpdate(()=>{this.meshList[t].view.wireMaterial.opacity=o.alphaB}).delay(3e3+20*t).start()}}removeBoard(){}createScene(){this.scene=new U.Scene,this.renderer=new U.WebGLRenderer({antialias:!0,alpha:!0}),this.renderer.setSize(window.innerWidth,window.innerHeight),this.renderer.setPixelRatio(window.devicePixelRatio),this.renderer.setClearColor(this.backgroundColor),this.renderer.shadowMap.enabled=!0,this.renderer.shadowMap.type=U.PCFSoftShadowMap,this.renderer.autoClear=!1,document.getElementById(g).appendChild(this.renderer.domElement)}createCamera(){this.camera=new U.PerspectiveCamera(60,window.innerWidth/window.innerHeight,1),this.camera.position.set(0,80,150),this.camera.lookAt(new U.Vector3(0,50,-80)),this.scene.add(this.camera)}addOrbitControls(){this.controls=new Ct.a(this.camera,this.renderer.domElement),this.controls.minPolarAngle=0,this.controls.maxPolarAngle=Math.PI,this.controls.minDistance=0,this.controls.maxDistance=1/0,this.enableZoom=!0,this.zoomSpeed=1,this.controls.enablePan=!0}addAmbientLight(){const t=new U.AmbientLight(4210752,1);this.scene.add(t)}addDirectionalLight(){const t=new U.DirectionalLight(16777215,1);t.position.set(0,300,30),this.scene.add(t)}}var Pt={...F,props:{instance:null},init(){return this.props.instance=new Mt,this.props.instance.init(),this},setup(){},update(){},draw(){this.props.instance.draw()},destroy(){},onResize(){this.props.instance.onResize()},onMouseMove(t){this.props.instance.onMouseMove(t)},onClick(t){this.props.instance.onClick(t)}},Lt=i(24),It=function(t){U.Object3D.call(this),this.element=t,this.element.style.position="absolute",this.element.style.pointerEvents="auto",this.addEventListener("removed",(function(){this.traverse((function(t){t.element instanceof Element&&null!==t.element.parentNode&&t.element.parentNode.removeChild(t.element)}))}))};(It.prototype=Object.create(U.Object3D.prototype)).constructor=It;var Dt=function(t){It.call(this,t)};(Dt.prototype=Object.create(It.prototype)).constructor=Dt;var Rt=function(){var t,e,i,s,o=new U.Matrix4,a={camera:{fov:0,style:""},objects:new WeakMap},r=document.createElement("div");r.style.overflow="hidden",this.domElement=r;var n=document.createElement("div");n.style.WebkitTransformStyle="preserve-3d",n.style.transformStyle="preserve-3d",n.style.pointerEvents="none",r.appendChild(n);var h=/Trident/i.test(navigator.userAgent);function l(t){return Math.abs(t)<1e-10?0:t}function c(t){var e=t.elements;return"matrix3d("+l(e[0])+","+l(-e[1])+","+l(e[2])+","+l(e[3])+","+l(e[4])+","+l(-e[5])+","+l(e[6])+","+l(e[7])+","+l(e[8])+","+l(-e[9])+","+l(e[10])+","+l(e[11])+","+l(e[12])+","+l(-e[13])+","+l(e[14])+","+l(e[15])+")"}function d(t,e){var o=t.elements,a="matrix3d("+l(o[0])+","+l(o[1])+","+l(o[2])+","+l(o[3])+","+l(-o[4])+","+l(-o[5])+","+l(-o[6])+","+l(-o[7])+","+l(o[8])+","+l(o[9])+","+l(o[10])+","+l(o[11])+","+l(o[12])+","+l(o[13])+","+l(o[14])+","+l(o[15])+")";return h?"translate(-50%,-50%)translate("+i+"px,"+s+"px)"+e+a:"translate(-50%,-50%)"+a}this.getSize=function(){return{width:t,height:e}},this.setSize=function(o,a){i=(t=o)/2,s=(e=a)/2,r.style.width=o+"px",r.style.height=a+"px",n.style.width=o+"px",n.style.height=a+"px"};var m,p,g=(m=new U.Vector3,p=new U.Vector3,function(t,e){return m.setFromMatrixPosition(t.matrixWorld),p.setFromMatrixPosition(e.matrixWorld),m.distanceToSquared(p)});function u(t){for(var e=function(t){var e=[];return t.traverse((function(t){t instanceof It&&e.push(t)})),e}(t).sort((function(t,e){return a.objects.get(t).distanceToCameraSquared-a.objects.get(e).distanceToCameraSquared})),i=e.length,s=0,o=e.length;s<o;s++)e[s].element.style.zIndex=i-s}this.render=function(t,e){var m=e.projectionMatrix.elements[5]*s;if(a.camera.fov!==m&&(e.isPerspectiveCamera?(r.style.WebkitPerspective=m+"px",r.style.perspective=m+"px"):(r.style.WebkitPerspective="",r.style.perspective=""),a.camera.fov=m),!0===t.autoUpdate&&t.updateMatrixWorld(),null===e.parent&&e.updateMatrixWorld(),e.isOrthographicCamera)var p=-(e.right+e.left)/2,f=(e.top+e.bottom)/2;var y=e.isOrthographicCamera?"scale("+m+")translate("+l(p)+"px,"+l(f)+"px)"+c(e.matrixWorldInverse):"translateZ("+m+"px)"+c(e.matrixWorldInverse),b=y+"translate("+i+"px,"+s+"px)";a.camera.style===b||h||(n.style.WebkitTransform=b,n.style.transform=b,a.camera.style=b),function t(e,i,s){if(e instanceof It){var r;e instanceof Dt?(o.copy(i.matrixWorldInverse),o.transpose(),o.copyPosition(e.matrixWorld),o.scale(e.scale),o.elements[3]=0,o.elements[7]=0,o.elements[11]=0,o.elements[15]=1,r=d(o,s)):r=d(e.matrixWorld,s);var l=e.element,c=a.objects.get(e);if(void 0===c||c.style!==r){l.style.WebkitTransform=r,l.style.transform=r;var m={style:r};h&&(m.distanceToCameraSquared=g(i,e)),a.objects.set(e,m)}l.parentNode!==n&&n.appendChild(l)}for(var p=0,u=e.children.length;p<u;p++)t(e.children[p],i,s)}(t,e,y),h&&u(t)}};class jt{constructor(t,e,i,s,o){var a=document.createElement("div");a.style.width="800px",a.style.height="450px";var r=document.createElement("iframe");r.style.width="800px",r.style.height="450px",r.style.border="0px",r.src=t,a.appendChild(r);var n=new It(a);return n.position.set(e,i,s),n.rotation.y=o,n}}const zt=window.pdfjsLib;class Gt{constructor(t,e,i,s){this.room_id="a07";var o=document.createElement("canvas");o.width=800,o.height=500;var a=o.getContext("2d");zt.getDocument(`./pdf/${this.room_id}.pdf`).promise.then((function(t){var e;e=1,t.getPage(e).then((function(t){var e=t.getViewport({scale:800/720}),i={canvasContext:a,viewport:e};t.render(i).promise.then((function(){console.log("Page rendered")}))}))}));var r=new It(o);return r.position.set(t,e,i),r.rotation.y=s,r}}var Vt={props:{isEnable:!1},init(){let{camera:t,scene:e,renderer:i,controls:s}=this.props;var o=document.getElementById(f);t=new U.PerspectiveCamera(50,window.innerWidth/window.innerHeight,1,5e3),t.position.set(0,0,2e3),e=new U.Scene,i=new Rt,i.setSize(window.innerWidth,window.innerHeight),o.appendChild(i.domElement);var a=new U.Group;a.add(new Gt(0,300,450,0)),a.add(new jt("https://www.youtube.com/embed/G9AtkiCESAg",1e3,0,0,-Math.PI/8)),a.add(new jt("https://www.youtube.com/embed/9PVjlAm-A1A",-1e3,0,0,Math.PI/8)),a.add(new jt("https://salty-waters-60310.herokuapp.com/a07",0,-300,450,0)),e.add(a),s=new Lt.a(t,i.domElement),s.rotateSpeed=4;var r=document.getElementById(y);r.style.display="none",s.addEventListener("start",(function(){r.style.display=""})),s.addEventListener("end",(function(){r.style.display="none"})),this.props={...this.props,camera:t,scene:e,renderer:i,controls:s},this.addEvent()},draw(){const{controls:t,renderer:e,scene:i,camera:s}=this.props;t.update(),e.render(i,s)},onResize(){const{controls:t,renderer:e,scene:i,camera:s}=this.props;s.aspect=window.innerWidth/window.innerHeight,s.updateProjectionMatrix(),e.setSize(window.innerWidth,window.innerHeight)},onKeyUp(t){t.keyCode===h&&this.hide()},addEvent(){document.addEventListener(l.ShowDetail,t=>this.show())},show(){const t=document.getElementById(u),e=document.getElementById(p);this.props.isEnable=!0,t.style.visibility="visible",e.style.visibility="hidden"},hide(){const t=document.getElementById(u),e=document.getElementById(p);this.props.isEnable=!1,t.style.visibility="hidden",e.style.visibility="visible"}};class Ft extends U.Scene{constructor(){super(),this.BillandCircle=this.BillandCircle.bind(this),this.opening=this.opening.bind(this),this.backAnimation=this.backAnimation.bind(this),this.BillandCircle(),this.openingFrame=0,this.backAnimationframeStart=550,this.backAnimationframe=this.backAnimationframeStart,this.waitingFrame=0,this.openingUpdateBool=!0,this.backAnimationUpdateBool=!1,this.meshList=[],this.meshGroup=new U.Group;const t=new U.MeshBasicMaterial({wireframe:!0,color:5154702,opacity:.5,transparent:!0,blending:U.AdditiveBlending});this.PlateNum=320,this.positions=[],this.posTarget=[];for(let e=0;e<this.PlateNum;e++)this.floorsize=27,this.geometry=new U.PlaneBufferGeometry(this.floorsize,this.floorsize),this.mesh=new U.Mesh(this.geometry,t),this.mesh.position.set(0,0,0),this.mesh.rotation.x=90*Math.PI/180,this.meshGroup.add(this.mesh),this.meshList.push(this.mesh),this.positions.push(400*(2*Math.random()-1),400*(2*Math.random()-1),400*(2*Math.random()-1)),this.posTarget.push(0,0,0);this.clock=new U.Clock,this.tSpeed=10,this.easeElapsedTime=0,this.eansingBool=!0,this.add(this.meshGroup),this.openingIsEnd=!1}BillandCircle(){const t=new U.Geometry;for(let e=0;e<30;e++){const e=new U.CircleGeometry(400*(Math.random()+.5),7),i=new U.Matrix4;i.makeTranslation(125,125,0),t.merge(e,i)}const e=new U.MeshBasicMaterial({wireframe:!0,color:5154702,opacity:.9,transparent:!0});this.circle=new U.Mesh(t,e),this.circle.rotation.x=90*Math.PI/180,this.add(this.circle);const i=new U.Geometry;let s=0;for(let t=0;t<420;t++){let e=50*(Math.random()+.5);const o=new U.BoxGeometry(10*(Math.random()+.5),e,10*(Math.random()+.5)),a=new U.Matrix4;t%60==0&&(s+=1),a.makeTranslation(140*(2*Math.random()-1)+400*Math.sin(50*s*Math.PI/180)+125,e/2,140*(2*Math.random()-1)+400*Math.cos(50*s*Math.PI/180)+125),i.merge(o,a)}const o=new U.MeshBasicMaterial({wireframe:!0,color:5154702,opacity:.4,transparent:!0,blending:U.AdditiveBlending}),a=new U.Mesh(i,o);this.add(a)}update(){if(this.circle.rotation.x=90*Math.PI/180,1==this.eansingBool){this.easeElapsedTime+=this.clock.getDelta(),this.t=this.easeElapsedTime/this.tSpeed,this.t>1&&(this.t=1),this.rate=this.t*this.t*(3-2*this.t);for(let t=0;t<this.meshList.length;t++){this.meshList[t].position.x=this.positions[3*t+0],this.meshList[t].position.y=this.positions[3*t+1],this.meshList[t].position.z=this.positions[3*t+2];for(let e=0;e<3;e++){let i=this.positions[3*t+e],s=this.posTarget[3*t+e];this.positions[3*t+e]=i*(1-this.rate)+s*this.rate}}}1==this.openingUpdateBool&&(this.openingFrame+=1,this.opening()),1==this.backAnimationUpdateBool&&(this.waitingFrame<240&&(this.waitingFrame+=1),this.waitingFrame>=240&&(this.waitingFrame=242,this.backAnimationframe+=1,this.backAnimation()))}opening(){if(170==this.openingFrame){for(let t=0;t<this.meshList.length;t++)for(let e=0;e<4;e++)if(t>=80*e&&t<80*(e+1))for(let i=0;i<4;i++)if(t>=80*e+20*i&&t<80*e+20*(i+1))for(let s=0;s<20;s++)t>=80*e+20*i+1*s&&t<80*e+20*i+1*(s+1)&&(this.posTarget[3*t+0]=20*e,this.posTarget[3*t+1]=5*s,this.posTarget[3*t+2]=20*i);this.easeElapsedTime=0,this.tSpeed=4}if(230==this.openingFrame){for(let t=0;t<this.meshList.length;t++)for(let e=0;e<4;e++)if(t>=80*e&&t<80*(e+1))for(let i=0;i<4;i++)if(t>=80*e+20*i&&t<80*e+20*(i+1))for(let s=0;s<10;s++)t>=80*e+20*i+2*s&&t<80*e+20*i+2*(s+1)&&(this.posTarget[3*t+0]=25*(e+s),this.posTarget[3*t+1]=15*s,this.posTarget[3*t+2]=25*(i+s));this.easeElapsedTime=0,this.tSpeed=7}370==this.openingFrame&&0==this.openingIsEnd&&(this.openingIsEnd=!0,this.openingUpdateBool=!1,this.openingFrame=0)}backAnimation(){if(50==this.backAnimationframe){for(let t=0;t<this.meshList.length;t++)for(let e=0;e<4;e++)t>=80*e&&t<80*(e+1)&&(this.posTarget[3*t+0]=25*e,this.posTarget[3*t+1]=0,this.posTarget[3*t+2]=0);this.easeElapsedTime=0,this.tSpeed=3}if(110==this.backAnimationframe){for(let t=0;t<this.meshList.length;t++)for(let e=0;e<4;e++)if(t>=80*e&&t<80*(e+1))for(let i=0;i<4;i++)t>=80*e+20*i&&t<80*e+20*(i+1)&&(this.posTarget[3*t+0]=25*e,this.posTarget[3*t+1]=0,this.posTarget[3*t+2]=25*i);this.easeElapsedTime=0}if(170==this.backAnimationframe){for(let t=0;t<this.meshList.length;t++)for(let e=0;e<4;e++)if(t>=80*e&&t<80*(e+1))for(let i=0;i<4;i++)if(t>=80*e+20*i&&t<80*e+20*(i+1))for(let s=0;s<20;s++)t>=80*e+20*i+1*s&&t<80*e+20*i+1*(s+1)&&(this.posTarget[3*t+0]=25*e,this.posTarget[3*t+1]=7*s,this.posTarget[3*t+2]=25*i);this.easeElapsedTime=0,this.tSpeed=4}if(280==this.backAnimationframe){for(let t=0;t<this.meshList.length;t++)for(let e=0;e<4;e++)if(t>=80*e&&t<80*(e+1))for(let i=0;i<4;i++)if(t>=80*e+20*i&&t<80*e+20*(i+1))for(let s=0;s<10;s++)t>=80*e+20*i+2*s&&t<80*e+20*i+2*(s+1)&&(this.posTarget[3*t+0]=45*i,this.posTarget[3*t+1]=10*s,this.posTarget[3*t+2]=45*e);this.easeElapsedTime=0,this.tSpeed=4}if(430==this.backAnimationframe){for(let t=0;t<this.meshList.length;t++)for(let e=0;e<4;e++)if(t>=80*e&&t<80*(e+1))for(let i=0;i<4;i++)if(t>=80*e+20*i&&t<80*e+20*(i+1))for(let s=0;s<10;s++)t>=80*e+20*i+2*s&&t<80*e+20*i+2*(s+1)&&(this.posTarget[3*t+0]=45*e,this.posTarget[3*t+1]=0,this.posTarget[3*t+2]=45*i);this.easeElapsedTime=0,this.tSpeed=7}if(490==this.backAnimationframe){for(let t=0;t<this.meshList.length;t++)for(let e=0;e<4;e++)if(t>=80*e&&t<80*(e+1))for(let i=0;i<4;i++)if(t>=80*e+20*i&&t<80*e+20*(i+1))for(let s=0;s<10;s++)t>=80*e+20*i+2*s&&t<80*e+20*i+2*(s+1)&&(this.posTarget[3*t+0]=30*e,this.posTarget[3*t+1]=0,this.posTarget[3*t+2]=30*i);this.easeElapsedTime=0,this.tSpeed=4}if(550==this.backAnimationframe){for(let t=0;t<this.meshList.length;t++)for(let e=0;e<8;e++)if(t>=40*e&&t<40*(e+1))for(let i=0;i<8;i++)if(t>=40*e+5*i&&t<40*e+5*(i+1))for(let s=0;s<5;s++)t>=40*e+5*i+1*s&&t<40*e+5*i+1*(s+1)&&(this.posTarget[3*t+0]=15*e,this.posTarget[3*t+1]=0,this.posTarget[3*t+2]=15*i);this.easeElapsedTime=0,this.tSpeed=2}if(600==this.backAnimationframe){for(let t=0;t<this.meshList.length;t++)for(let e=0;e<20;e++)if(t>=16*e&&t<16*(e+1))for(let i=0;i<16;i++)if(t>=16*e+1*i&&t<16*e+1*(i+1))for(let s=0;s<1;s++)t>=16*e+1*i+1*s&&t<16*e+1*i+1*(s+1)&&(this.posTarget[3*t+0]=20*e,this.posTarget[3*t+1]=30*Math.sin((30*(e+i)+2*(this.backAnimationframe+60))*Math.PI/180),this.posTarget[3*t+2]=20*i);this.easeElapsedTime=0}if(660==this.backAnimationframe&&(this.eansingBool=!1),this.backAnimationframe>=660&&this.backAnimationframe<980){for(let t=0;t<this.meshList.length;t++)this.meshList[t].position.x=this.positions[3*t+0],this.meshList[t].position.y=this.positions[3*t+1],this.meshList[t].position.z=this.positions[3*t+2];for(let t=0;t<this.meshList.length;t++)for(let e=0;e<20;e++)if(t>=16*e&&t<16*(e+1))for(let i=0;i<16;i++)if(t>=16*e+1*i&&t<16*e+1*(i+1))for(let s=0;s<1;s++)t>=16*e+1*i+1*s&&t<16*e+1*i+1*(s+1)&&(this.positions[3*t+0]=20*e,this.positions[3*t+1]=30*Math.sin((30*(e+i)+2*this.backAnimationframe)*Math.PI/180),this.positions[3*t+2]=20*i)}if(980==this.backAnimationframe&&(this.eansingBool=!0),1e3==this.backAnimationframe){for(let t=0;t<this.meshList.length;t++)for(let e=0;e<4;e++)if(t>=80*e&&t<80*(e+1))for(let i=0;i<4;i++)if(t>=80*e+20*i&&t<80*e+20*(i+1))for(let s=0;s<10;s++)t>=80*e+20*i+2*s&&t<80*e+20*i+2*(s+1)&&(this.posTarget[3*t+0]=70*Math.sin(4*t*Math.PI/180)+50,this.posTarget[3*t+1]=70*Math.cos(40*(e+i+s)*Math.PI/180)+25,this.posTarget[3*t+2]=-70*Math.sin(8*t*Math.PI/180)+50);this.easeElapsedTime=0,this.tSpeed=12}if(1150==this.backAnimationframe){for(let t=0;t<this.meshList.length;t++)for(let e=0;e<20;e++)if(t>=16*e&&t<16*(e+1))for(let i=0;i<16;i++)if(t>=16*e+1*i&&t<16*e+1*(i+1))for(let s=0;s<1;s++)t>=16*e+1*i+1*s&&t<16*e+1*i+1*(s+1)&&(this.posTarget[3*t+0]=10*e,this.posTarget[3*t+1]=0,this.posTarget[3*t+2]=10*i);this.easeElapsedTime=0,this.tSpeed=4}}}class Ut extends U.Scene{constructor(){super(),this.cam_opening=this.cam_opening.bind(this),this.cam_backAnimation=this.cam_backAnimation.bind(this),this.resetCamTargetBool=this.resetCamTargetBool.bind(this),this.openCamTargetBool=this.openCamTargetBool.bind(this),this.chooseRoom=this.chooseRoom.bind(this),this.VR_action=this.VR_action.bind(this),this.baseCamTarget=new U.Vector3(-230,-65,-270),this.baseCamTargetPlus=new U.Vector3(230,65,270),this.camPos=new U.Vector3(0,-100,-240),this.camTarget=new U.Vector3(-140,0,-140),this.keyBool_startVRanime=!0,this.updateBool=!1,this.resetCamTargetBool(),this.camTargetBool_BACKSPACE=!1}setup(){this.VR_action()}update(){1==this.updateBool&&(this.camPos.x+=.02*(this.camTarget.x-this.camPos.x),this.camPos.y+=.02*(this.camTarget.y-this.camPos.y),this.camPos.z+=.02*(this.camTarget.z-this.camPos.z),this.scene0.position.set(this.camPos.x,this.camPos.y,this.camPos.z),this.scene0.rotation.y=45*Math.PI/180,this.scene0.update(),1==this.scene0.scene2.openingUpdateBool&&this.cam_opening(),1==this.scene0.scene2.backAnimationUpdateBool&&242==this.scene0.scene2.waitingFrame&&this.cam_backAnimation(),1==this.scene0.scene2.openingIsEnd&&(console.log("VR Opening is end!"),this.camTarget=this.baseCamTarget,this.openCamTargetBool(),this.scene0.scene2.openingIsEnd=!1))}VR_action(){r.add(a.VRModeStart,()=>{1==this.keyBool_startVRanime&&(this.keyBool_startVRanime=!1,this.scene0=new Ot,this.add(this.scene0),this.updateBool=!0,console.log("start VR anime!"))}),r.add(a.ShowCategoryA,()=>{console.log("ふむ"),this.chooseRoom(this.camTargetBool_A,0,"Go to room_A!")}),r.add(a.ShowCategoryD,()=>{this.chooseRoom(this.camTargetBool_D,0,"Go to room_D!")}),r.add(a.ShowCategoryG,()=>{this.chooseRoom(this.camTargetBool_G,0,"Go to room_G!")}),r.add(a.BackToCategory,()=>{1==this.camTargetBool_BACKSPACE&&(this.camTargetBool_BACKSPACE=!1,this.scene0.scene2.backAnimationUpdateBool=!1,this.scene0.scene2.backAnimationframe=this.scene0.scene2.backAnimationframeStart,this.scene0.scene2.waitingFrame=0,this.scene0.scene2.openingUpdateBool=!0,this.baseCamTarget=new U.Vector3(-230,-65,-270),this.camTarget=this.baseCamTarget,console.log("Please back to 7 panels!"),this.openCamTargetBool())})}onKeyUp(t){t.keyCode==W&&1==this.keyBool_startVRanime&&(this.keyBool_startVRanime=!1,this.scene0=new Ot,this.add(this.scene0),this.updateBool=!0,console.log("start VR anime!")),t.keyCode==H&&this.chooseRoom(this.camTargetBool_A,0,"Go to room_A!"),t.keyCode==$&&this.chooseRoom(this.camTargetBool_B,1,"Go to room_B!"),t.keyCode==N&&this.chooseRoom(this.camTargetBool_C,3,"Go to room_C!"),t.keyCode==q&&this.chooseRoom(this.camTargetBool_D,4,"Go to room_D!"),t.keyCode==J&&this.chooseRoom(this.camTargetBool_E,6,"Go to room_E!"),t.keyCode==X&&this.chooseRoom(this.camTargetBool_F,7,"Go to room_F!"),t.keyCode==Z&&this.chooseRoom(this.camTargetBool_G,9,"Go to room_G!"),t.keyCode==Q&&1==this.camTargetBool_BACKSPACE&&(this.camTargetBool_BACKSPACE=!1,this.scene0.scene2.backAnimationUpdateBool=!1,this.scene0.scene2.backAnimationframe=this.scene0.scene2.backAnimationframeStart,this.scene0.scene2.waitingFrame=0,this.scene0.scene2.openingUpdateBool=!0,this.baseCamTarget=new U.Vector3(-230,-65,-270),this.camTarget=this.baseCamTarget,console.log("Please back to 7 panels!"),this.openCamTargetBool())}cam_opening(){}cam_backAnimation(){250==this.scene0.scene2.backAnimationframe&&(this.camTarget=new U.Vector3(-150,-50,-50)),this.scene0.scene2.backAnimationframe==this.scene0.scene2.backAnimationframeStart+2&&(this.camTarget=new U.Vector3(-150,-100,-150)),1100==this.scene0.scene2.backAnimationframe&&(this.camTarget=new U.Vector3(70,-80,-200))}chooseRoom(t,e,i){1==t&&(t=!1,this.lookTarget=new U.Vector3(35.25*(1.5+e),8+15*e,0*(1.5+e)),this.camTarget.subVectors(this.lookTarget,this.baseCamTargetPlus),this.camTarget.multiplyScalar(.95),this.camTarget.add(this.baseCamTargetPlus),this.camTarget.multiplyScalar(-1),console.log(i),this.resetCamTargetBool())}resetCamTargetBool(){this.camTargetBool_BACKSPACE=!0,this.camTargetBool_A=!1,this.camTargetBool_B=!1,this.camTargetBool_C=!1,this.camTargetBool_D=!1,this.camTargetBool_E=!1,this.camTargetBool_F=!1,this.camTargetBool_G=!1}openCamTargetBool(){this.camTargetBool_BACKSPACE=!1,this.camTargetBool_A=!0,this.camTargetBool_B=!0,this.camTargetBool_C=!0,this.camTargetBool_D=!0,this.camTargetBool_E=!0,this.camTargetBool_F=!0,this.camTargetBool_G=!0}}class Ot extends U.Scene{constructor(){super(),this.scene2=new Ft,this.add(this.scene2)}update(){this.scene2.update()}}U.Scene;var Wt=window.AFRAME.registerComponent(E,{props:{},modules:{},init(){console.log("Background Component Init."),this.props.scene=this.el.object3D;const t=document.createElement("a-entity");t.setAttribute("id",c),this.props.container=this.el.appendChild(t),this.modules.scene=new Ut,this.modules.scene.setup(),setTimeout(()=>{this.props.container.object3D.add(this.modules.scene)},1e3)},tick(){this.modules.scene.update()},onKeyUp(t){null!=this.modules.scene&&this.modules.scene.onKeyUp(t)}});i(48);class Kt{constructor(t){this.params=t,this.index=t.index||0,this.name=t.name||t.boardID||"Board"+Date.now(),this.category=t.category,this.boardId=t.boardId||L,this.entities={board:null},this.width=12,this.height=.5625*this.width,this.position=new U.Vector3,this.rotation=new U.Vector3,this.scale=new U.Vector3(this.width,this.height,1),this.containers={board:document.getElementById(b),boardContent:null,boardContentBody:null,...t.containers},this.materials={board:"shader: html; color: #ccc; transparent: true; target: #"+this.name}}createBoard(t="board",e=this.containers.board,i=this.materials.board,s=!0){this.entities[t]=document.createElement("a-entity"),this.entities[t].setAttribute("geometry","primitive: plane"),this.entities[t].setAttribute("material",i),this.entities[t].setAttribute(P,""),s&&this.entities[t].setAttribute("class",C),this.entities[t].instance=this,e.appendChild(this.entities[t])}createContent(t="",e=this.containers.boardContent){const i=document.createElement("div");return i.setAttribute("id",""+this.name),i.insertAdjacentHTML("afterbegin",t),e.appendChild(i),i}draw(){this.entities.forIn((t,e)=>{e.setAttribute("position",this.position),e.setAttribute("rotation",this.rotation),e.setAttribute("scale",this.scale)})}destroy(){this.containers.board.removeChild(this.entities.board),null!=this.containers.boardContent&&null!=this.containers.boardContentBody&&this.containers.boardContent.removeChild(this.containers.boardContentBody),this.entities.board.destroy()}setPosition(t,e,i){this.position.set(t,e,i)}lookAt(t){null!=t&&t instanceof U.Vector3||(t=new U.Vector3);const e=180+180*Math.atan2(this.position.x-t.x,this.position.z-t.z)/Math.PI;this.rotation.set(0,e,0)}onRaycastForcedOn(t){}onRaycastForcedOff(t){}}class Ht extends Kt{constructor(t){super(t),this.width=12,this.height=12,this.scale=new U.Vector3(this.width,this.height,1),this.init()}init(){let t='<div class="hud_ui">';switch(this.boardId){case R.ShowCategoryA:t+="A";break;case R.ShowCategoryD:t+="D";break;case R.ShowCategoryG:t+="G";break;case R.VRModeStart:t+="VR Mode Start";break;default:t+="BACK"}t+="</div>",this.containers.boardContentBody=this.createContent(t),this.createBoard()}}var $t={init_base(t){this.scene=t,this.containers={hud:{back:null}},this.boardList=[],this.hudUIList=[]},init(t){this.init_base(t)},draw(){this.boardList.forEach(t=>t.draw()),this.hudUIList.forEach(t=>t.draw())},destroy(){this.boardList.forEach(t=>t.destroy()),this.hudUIList.forEach(t=>t.destroy())},generateContainer(t,e){const i=document.getElementById(t);if(null!=i)return i;const s=document.createElement("a-entity");return s.setAttribute("id",t),e.appendChild(s)},generateHUD(t=R.BackToCategory,e=[0,12,-20]){this.containers[t]=this.generateContainer(T,this.scene);const i=document.getElementById(d),s={boardId:t,containers:{board:this.containers[t],boardContent:i}},o=new Ht(s);o.setPosition(...e),this.hudUIList.push(o)},showBoard(t,e=this.boardList,i=20,s=null){const o=e.length,a=null!=t?t+2:360/o;s=null==s?-90-(o-1)*a/2:s;for(let t=0;t<o;t++){const o=e[t],r=t*a+s;o.setPosition(i*Math.cos(U.Math.degToRad(r)),o.position.y,i*Math.sin(U.Math.degToRad(r))),o.lookAt()}}};class Nt extends Kt{constructor(t){super(t),this.name="poster"+t.index,this.boardId=I,this.materials={board:"shader: flat; color: #999; src: "+t.containers.boardContentBody,title:"shader: html; color: #999; transparent: true; target: #"+this.name},this.entities={...this.entities,title:null},this.slug=this.category+(this.index<10?"0":"")+this.index,this.init()}init(){this.containers.titleContentBody=this.createContent(`\n    <div class="gallery_poster_title">${this.containers.titleContentBody}</div>\n    `,this.containers.titleContent),this.containers.title.object3D.position.set(0,-6.75,0),this.createBoard("title",this.containers.title,this.materials.title,!1),this.createBoard()}destroy(){super.destroy(),null!=this.containers.titleContentBody&&(this.containers.title.removeChild(this.entities.title),this.containers.titleContent.removeChild(this.containers.titleContentBody),this.entities.title.destroy())}onRaycastForcedOn(t){this.entities.title.object3DMap.mesh.material.color=new U.Color(1,1,1)}onRaycastForcedOff(t){this.entities.title.object3DMap.mesh.material.color=new U.Color(.6,.6,.6)}}class qt extends Kt{constructor(t){super(t),this.width=12,this.height=this.width,this.scale=new U.Vector3(this.width,this.height,1),this.init()}init(){this.containers.boardContentBody=this.createContent((t=>{const e="abcdefs".substr(t.index,1),{categoryEn:i,categoryJp:s,copy:o}=t.data[e],a="s"===e?"特別展示":e.toUpperCase();return`\n\t\t<div class="category_content_container category_${e}">\n\t\t\t<div class="category_id">${a}</div>\n\t\t\t<div class="category_title english">${i}</div>\n\t\t\t<div class="category_title japanese">${s}</div>\n\t\t\t<div class="category_copy">${o}</div>\n\t\t</div>\n\t`})(this.params)),this.createBoard()}}var Jt={...$t,init(t){this.init_base(t),this.containers={...this.containers,category:{board:null},poster:{panel:null,title:null}},this.currentCategory="",this.addEvent(),this.generateCategory(vt)},generatePosters(t=this.currentCategory){this.currentCategory=t,this.containers.poster.panel=this.generateContainer(x,this.scene),this.containers.poster.title=this.generateContainer(B,this.containers.poster.panel),this.containers.poster.titleContent=document.getElementById(g),this.boardList.length=0,this.hudUIList.length=0;const e=vt[t],i=e.imgPath.length;for(let s=0;s<i;s++){const i={index:s+1,name:"poster"+s,category:t,boardId:I,containers:{board:this.containers.poster.panel,boardContentBody:e.imgPath[s],title:this.containers.poster.title,titleContent:this.containers.poster.titleContent,titleContentBody:e.posterTitle[s]},data:e};this.boardList.push(new Nt(i))}this.generateHUD(),this.showBoard(34)},generateHUDs(){this.generateHUD(R.BackToCategory,[0,12,0]),V(()=>{this.generateHUD(R.ShowCategoryA,[0,12,0],10)}),V(()=>{this.generateHUD(R.ShowCategoryD,[0,12,0],20)}),V(()=>{this.generateHUD(R.ShowCategoryG,[0,12,0],30)}),V(()=>{this.generateHUD(R.VRModeStart,[0,12,0],40)}),V(()=>{this.showBoard(34,this.boardList,20),this.showBoard(34,this.hudUIList,20,-150)},50)},generateCategory(t=vt){this.containers.category.board=this.generateContainer(v,this.scene),this.boardList.length=0,this.hudUIList.length=0;const e=document.getElementById(m),i=Object.keys(t),s=i.length;for(let o=0;o<s;o++){const s={index:o,name:"category"+o,category:i[o],boardId:L,containers:{board:this.containers.category.board,boardContent:e},data:t};this.boardList.push(new qt(s))}this.generateHUDs()},addEvent(){r.add(a.ShowPoster,t=>{console.log("Category "+t),null!=t&&(this.destroy(),this.generatePosters(t))}),r.add(a.ShowDetail,()=>this.destroy()),r.add(a.BackToCategory,()=>{this.destroy(),this.generateCategory(vt)}),r.add(a.BackToPoster,()=>this.generatePosters())}};var Xt=window.AFRAME.registerComponent(S,{props:{},modules:{},init(){console.log("Gallery Component Init."),this.props.scene=this.el.object3D,this.props.container=this.el.appendChild(document.createElement("a-entity")),this.modules.gallery=Jt,this.modules.gallery.init(this.props.container)},tick(){null!=this.modules.gallery&&this.modules.gallery.draw()},onKeyUp(t){}});class Zt extends Kt{constructor(t){super(t),this.width=18,this.height=18,this.scale=new U.Vector3(this.width,this.height,1),this.materials={board:"shader: html; color: #fff; transparent: true; target: #"+this.name},this.init()}init(){const{data:t}=this.params,e=Object.keys(t)[0];switch(e){case"image":this.materials.board="shader: flat; color: #fff; src: ./../session/pdf_img/"+t[e],this.width=18,this.height=.5625*this.width,this.scale=new U.Vector3(this.width,this.height,1);break;default:t[e].key=e,this.containers.boardContentBody=this.createContent((t=>{const{slug:e,category_jp:i,category_en:s,theme_jp:o,theme_en:a,title_jp:r,title_en:n,leader_name_jp:h,leader_name_en:l,research_field_jp:c,research_field_en:d,group_members_jp:m,group_members_en:p,summary_jp:g,summary_en:u,summary_split:f}=t;let y=`\n\t<div class="detail_content_container summary entry_${e}">\n\t<div class="detail_content_container_inner">\n\t`;switch(t.key){case"meta":y=`${y}\n\t\t\t<header class="detail_header_container">\n\t\t\t<div class="slug">${e.toUpperCase()}</div>\n\t\t\t<p class="category_jp">${i}</p>\n\t\t\t<p class="category_en">${s}</p>\n\t\t\t</header>\n\n\t\t\t<div class="detail_theme_container">\n\t\t\t<p class="theme_jp">${o}</p>\n\t\t\t<p class="theme_en">${a}</p>\n\t\t\t</div>\n\t\t\t<div class="detail_title_container">\n\t\t\t<h1 class="title_jp">${r}</h1>\n\t\t\t<p class="title_en">${n}</p>\n\t\t\t</div>\n\t\t\t<div class="detail_author_container">\n\t\t\t<p class="leader_name_jp">${h}</p>\n\t\t\t<p class="leader_name_en">${l}</p>\n\t\t\t<p class="research_field_jp">${c}</p>\n\t\t\t<p class="research_field_en">${d}</p>\n\t\t\t<p class="group_members_jp">${m}</p>\n\t\t\t<p class="group_members_en">${p}</p>\n\t\t\t</div>\n\t\t\t`;break;case"summary":y=`${y}\n\t\t\t<div class="detail_summary_container ${f?"split":""}">\n\t\t\t<p class="summary_jp">${g||""}</p>\n\t\t\t<p class="summary_en">${(g==u?"":u)||""}</p>\n\t\t\t</div>\n\t\t\t`}return y+="</div></div>",y})(t[e]))}this.createBoard("board",this.containers.board,this.materials.board,!1)}}var Qt={...$t,init(t){this.init_base(t),this.containers={...this.containers,detail:{}},this.addEvent()},fetchEntry:t=>new Promise((e,i)=>{pt.a.get("https://openhouse.nii.ac.jp/wp/wp-json/wp/v2/posts/?slug="+t).then(t=>{"data"in t&&t.data.length>0?e(t.data[0].acf):i("Data is empty.")}).catch(t=>{i(t)})}),async generateContent(t="a01"){this.containers.detail.board=this.generateContainer(k,this.scene),this.boardList.length=0,this.hudUIList.length=0;const e=[],i=document.getElementById(f),s=await this.fetchEntry(t).catch(t=>{console.error(t),r.dispatch(a.BackToPoster)});[s.pdf_name_01,s.pdf_name_02,s.pdf_name_03].filter(t=>""!=t).forEach(t=>{e.push({image:t+".png"})});const{category_jp:o,category_en:n,theme_jp:h,theme_en:l,title_jp:c,title_en:d,leader_name_jp:m,leader_name_en:p,research_field_jp:g,research_field_en:u,group_members_jp:y,group_members_en:b}=s;e.push({meta:{slug:t,category_jp:o,category_en:n,theme_jp:h,theme_en:l,title_jp:c,title_en:d,leader_name_jp:m,leader_name_en:p,research_field_jp:g,research_field_en:u,group_members_jp:y,group_members_en:b}});const{summary_jp:w,summary_en:_}=s,C=Array.from(w).length>250;C?(e.push({summary:{slug:t,summary_split:C,summary_jp:w}}),e.push({summary:{slug:t,summary_split:C,summary_en:_}})):e.push({summary:{slug:t,summary_split:C,summary_jp:w,summary_en:_}});const T=e.length;for(let t=0;t<T;t++){const s={index:t,name:"detail_"+t,boardId:D,containers:{board:this.containers.detail.board,boardContent:i},data:e[t]};this.boardList.push(new Zt(s))}this.showBoard(54,this.boardList,18),this.generateHUD(R.BackToPoster,[0,15,-20])},addEvent(){r.add(a.ShowDetail,t=>this.generateContent(t.slug)),r.add(a.BackToPoster,()=>this.destroy())}};var Yt=window.AFRAME.registerComponent(A,{props:{},modules:{},init(){console.log("Detail Component Init."),this.props.scene=this.el.object3D,this.props.container=this.el.appendChild(document.createElement("a-entity")),this.modules.detail=Qt,this.modules.detail.init(this.props.container)},tick(){null!=this.modules.detail&&this.modules.detail.draw()},onKeyUp(t){}});var te=window.AFRAME.registerComponent(M,{props:{},init:function(){this.el.addEventListener("raycaster-intersection",t=>{const e=t.detail.intersections;e.length>0&&(e[0].object.el.instance.onRaycastForcedOn(this.el),e[0].object.material.color.set(z))}),this.el.addEventListener("raycaster-intersection-cleared",t=>{const e=t.detail.clearedEls;for(var i=0;i<e.length;i++){const t=e[i].object3DMap;"mesh"in t&&(t.mesh.el.instance.onRaycastForcedOff(this.el),t.mesh.material.color.set(j))}})}});var ee=window.AFRAME.registerComponent(P,{init(){this.el.addEventListener("click",t=>{switch(this.el.object3DMap.mesh.material.color.set(16711680),this.el.instance.boardId){case I:r.dispatch(a.ShowDetail,{slug:this.el.instance.slug});break;case L:r.dispatch(a.ShowPoster,this.el.instance.category);break;case R.BackToCategory:r.dispatch(a.BackToCategory);break;case R.BackToPoster:r.dispatch(a.BackToPoster);break;case R.VRModeStart:r.dispatch(a.VRModeStart);break;case R.ShowCategoryA:r.dispatch(a.ShowCategoryA);break;case R.ShowCategoryD:r.dispatch(a.ShowCategoryD);break;case R.ShowCategoryG:r.dispatch(a.ShowCategoryG)}})}});var ie={...F,props:{elements:{}},components:{},init(){return console.log("XR App Init."),this.components.background=Wt,this.components.gallery=Xt,this.components.detail=Yt,this.components.raycastCheck=te,this.components.raycastTarget=ee,this},setup(){this.props.elements.scene=document.getElementById(b),this.attachComponent(this.props.elements.scene,E),this.attachComponent(this.props.elements.scene,S),this.attachComponent(this.props.elements.scene,A),this.props.elements.xr_player=this.attachComponent(document.getElementById(w),M),this.props.elements.xr_raycaster=document.getElementById(_),this.attachComponent(this.props.elements.xr_raycaster,"raycaster","objects: ."+C),this.attachComponent(this.props.elements.xr_raycaster,"cursor","fuse: false; fuse-timeout: 2000")},attachComponent:(t,e,i="")=>null!=t?t.setAttribute(e,i):null,onKeyUp(t){null!=this.components.background&&this.components.background.prototype.onKeyUp(t)}};var se={...F,props:{instance:null},init(){return this.props.instance=ie.init(),this},setup(){this.props.instance.setup()},update(){},draw(){},destroy(){},onResize(){this.props.instance.onResize()},onMouseMove(t){this.props.instance.onMouseMove(t)},onKeyUp(t){this.props.instance.onKeyUp(t)}};i(25);var oe={props:{isPause:!1},instances:{},init(){return G()?this.instances.xr=se.init():(this.instances.background=_t.init(),this.instances.gallery=Pt.init()),this.addEvent(),this.setup(),this},setup(t={}){this.instances.forIn((t,e)=>e.setup()),this.update()},update(){this.instances.forIn((t,e)=>e.update()),window.requestAnimationFrame(()=>{this.props.isPause||this.update()}),this.draw()},draw(){this.instances.forIn((t,e)=>e.draw())},destroy(){},pause(){this.props.isPause=!0},resume(){this.props.isPause=!1},onResize(){this.instances.forIn((t,e)=>e.onResize())},onMouseMove(t){this.instances.forIn((e,i)=>i.onMouseMove(t))},onKeyUp(t){this.instances.forIn((e,i)=>i.onKeyUp(t))},onClick(t){this.instances.forIn((e,i)=>i.onClick(t))},addEvent(t){}};const ae={};ae.PosterSession=ae.PosterSession||{},ae.PosterSession.App={delegator:null,init(){this.addExtensions(),this.delegator=oe.init(),this.addEvent()},onResize(){this.delegator.onResize()},onMouseMove(t){this.delegator.onMouseMove(t)},onKeyUp(t){this.delegator.onKeyUp(t)},onClick(t){this.delegator.onClick(t)},addEvent(){window.addEventListener("resize",()=>this.onResize()),window.addEventListener("mousemove",t=>this.onMouseMove(t)),window.addEventListener("keyup",t=>this.onKeyUp(t)),document.addEventListener("click",t=>this.onClick(t))},addExtensions(){s.init()}},window.addEventListener("DOMContentLoaded",()=>{((t=!0)=>{n.enable=t})(document.getElementsByTagName("a-scene").length>0),console.log("VRMode: "+G()),ae.PosterSession.App.init()})}});